function [Y,Xf,Af] = nnmove_22(X,~,~)
%NNMOVE_22 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:43.
% 
% [Y] = nnmove_22(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.644786415382709;-2.24855099234896;-0.581789816284725;-1.89546903030855];
x1_step1.gain = [1.42933908693485;0.45598879896227;1.88894161457496;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.5559679138032715962;2.5082437409046369758;2.5661505766455339206;-2.0381653050685630824;1.2335402490888831561;2.072322265753413717;-1.01191285338672321;1.2424626285413047366;0.58944524373565354569;0.051087677787956337072;0.36333476245243206959;0.43100334810999374469;-0.89402067603131263329;-2.2871083797864866227;-1.9434592563754413685;1.8281212669508468682;-2.3013790155640792001;-2.0397060884768380973;-2.7744011383871725052;-2.8317295719347432836];
IW1_1 = [-1.4316934381443355839 -0.14930382289116544969 -2.741880261109079342 -1.8965604252493244442;-1.7396225642059903738 -2.2073048590553647763 -0.74364691619274392309 0.98308068453673325138;-0.98865731911163723389 0.64213662870842469488 1.8754440840408761471 2.1303628035605370883;1.982701195819946749 0.75920035315892397954 1.1951691489560447579 -1.3491268896685841838;-0.41453929078603107827 1.7498539291530461615 1.9993930441925138464 -1.2202733785334036742;-2.0878450178977479013 0.17313087768954973922 1.0785321113438008922 0.60263575821661385934;0.19522425664192480377 -2.3403505559812174397 -1.4088171177658630473 -1.8117866874668786537;-0.2327185054263575803 -1.897742649903812806 1.725711885325674988 1.0526856479863875293;0.95181792240634999214 3.4011052686425786717 -0.49026513957830403223 0.46325263549437095678;0.77464484058260685284 2.4430370864087875837 0.4552088774420781081 -0.97081446944686522471;1.831889055220265794 -0.44545862791756518639 -1.9054873167736772199 0.50001240477955732899;-0.11902690654808427417 -1.2964619979127414151 -1.7924686857262115414 -0.79901180464273180437;-1.3750875621105944635 -0.4714388136640700333 -1.5521095224287897452 0.44032883519922599858;-1.0833257823317183899 -0.7286618062688081654 2.7451472187067258446 -0.19218975902457674509;-0.62554074319336938625 -1.8498156804509759965 0.74030946273031950078 -1.8978899700584495047;1.0340510288700675012 2.029134265064938436 -0.53498556725949253376 -2.513804883690803571;-1.4282541963071038182 -2.0195893264862236904 1.7586592493990302888 1.5574145576295825855;-1.512329718877885254 2.3564464073715587489 -0.6982214558395537507 -0.57629051936843056492;-1.2313439897949336466 1.7902888514686450261 -1.6792020134153307076 -1.3226170444230189727;-1.2806230555099473722 -1.6023059484009003484 -1.1096478156999383113 -1.9537634287259733057];

% Layer 2
b2 = [1.9058604601662350042;1.2674558706606773306;-1.1118195606197258662;0.54850609920677018128;0.17062550343981378043;0.32082278264645652799;0.75145700633520295941;-0.88504195111430306042;1.2311087028477527561;1.5116524903000152502];
LW2_1 = [-0.34317982853807393884 0.038315237484484961084 -0.19413573916003135089 0.095866121652277203058 0.048759008178173898762 0.37544917929938614876 0.92191005627138289391 -0.53274215538519065216 1.6981346388941125358 -0.061710568372143163873 -0.33489667484937679642 -0.31175722024937019272 -0.54695784433018779236 0.93366998424088021302 -0.48349170236704280823 -1.0216478434164544264 0.38395804409169648208 -0.1881353145507841107 0.22211416824359400679 0.23314723178511667645;0.070739577201124406725 0.1331616735457337164 0.51019739372406158751 -0.48485925673098834165 -0.55628916888511259486 0.070270218172335724427 0.17833294015359008045 0.443661542514134144 -0.81486038805170690758 -0.81535453011934133638 0.42058796469537851337 0.56497756914237728942 -0.84421700771641328132 0.3645374579741421095 0.25608162347743657072 0.64730522332904638638 0.58554304596242523484 0.11401980700966987681 0.14287566908439278124 -0.045011610447286139192;0.61169640245723044814 0.15326295283537466618 0.047151036865451655122 -0.21689519851666677619 -0.45670341218471366407 0.6545480061429543861 0.018500755481794747132 -0.95031557520792342419 -0.069568239207306481475 0.34953722301302164732 0.097286499672152471074 -0.80396546259784518185 0.34363388957274104696 0.070164803884035148451 -0.069573522235893900389 0.35277530807114176881 -0.93510023426879029795 0.1648475382175793591 -0.30631423611363717274 0.66337216024190637231;-1.2952686616239483808 0.0025991036387431232409 -0.52047579068242888489 0.19356897273652495794 0.27505798644300005762 0.024317919606159026091 -1.2875088602000219762 -0.27905257597036775552 0.10802768955914850146 0.4002894504952700383 0.45540980530684954664 0.41972387593610921419 -0.43079015558307964806 0.0015195064212113287318 -0.32737917321231535528 0.074474574702901197298 -0.12258860781945381258 0.36541271153660725979 -0.37973753835957607672 0.1294623555766156453;-0.50235036540331778898 -0.36910289360372511291 -0.29346301822256387615 -0.13655061325518486059 -0.071237859515173335145 -0.21368390974414924743 0.54558483682572944673 0.09017499427568409498 -0.16555184285074239781 -0.17138568908058832152 0.59505890973590735982 -0.34216348353462616716 0.32581864444944763637 0.20687918259503015883 0.37310808927045763239 -0.085204843456113676936 0.4509103182810677013 0.338003525299225005 -0.20190225140108139512 0.53050491292108614694;0.2242962395657288055 -0.31756318516128434482 -0.41825192400924954272 0.43145926768985537469 -0.31130662917526674693 -0.23460382407489591139 0.25318220272700042717 -0.50284748288602176824 0.77194716174239941253 0.20266034647685743364 -0.039237214930380459599 -0.29562911261771757099 -0.1138254105302136665 -0.058841549524429541396 0.030839676429693877596 -0.088403070446286605155 0.27692922955557891518 0.39061050635900201877 0.25228016492814214766 -0.52779902763559705114;0.66493890033097746706 -0.33381388560422037282 -0.42220970472044294652 0.15005735314420939885 -0.3424339856315730124 -0.015037808146362491302 -0.50707369962287518472 -0.40683593825333413951 -0.70735347343407772858 -0.31247853070847925183 -0.10863676069098267274 0.10152382990253853989 -0.60490898792527081351 -0.094210789196474534202 0.5900071506767817775 0.090632451062302332723 0.74430003269160449619 -0.24975871232206389716 -0.38449453799496097206 0.38469640588689746341;0.080541035201376440233 0.44505455492227025127 0.016696775389536448742 0.022685315373175099496 0.17742888720251873136 0.23048607806466434034 0.32527180799651977949 0.086300281352118951572 -0.04074610091411742796 -0.025144701119540403822 0.084291016683783748231 0.54428480630964071185 -0.18222169515308583865 0.97149747718481838099 0.094765274943254179663 -0.43291461088914140465 -0.93362645059257531877 -0.48303531245522079995 0.036058801457267947166 0.26798257684235510245;0.23506475522679784462 0.18028376809972013195 -0.5675710647716830648 0.051507051272737552905 0.10277516030796743363 0.24736374228249483065 -0.073855802198088751909 0.17764710008892192761 0.59976982270305023714 0.54751734017694886347 0.14747223124690872487 -0.91015299431988150314 -0.2685770714115915947 0.26328289786018921337 -0.47705057546908813393 -0.33667502151196537774 -0.65803237412928106131 -0.0087019837103461030597 0.45901863403585918544 0.25605217307544730909;-0.41039551997310769194 0.40476001294648022988 -0.2258288107734052752 -0.47208432959563423337 -0.45062027159819872946 -0.13966426428513908919 0.39181900730632723828 -0.90774414177732798414 0.12581030844838475558 -0.55770096246518263694 -0.24457197652429840673 -0.064966583033725891494 -0.22372475652021237003 -0.75888932855109103581 -0.19426661785781174085 -0.072242723277849918428 -0.074431719355551331785 0.42740265485650547062 0.77103133944015733725 -0.33279241286952560008];

% Layer 3
b3 = [-1.7981190081527240743;1.8733315055950825467;1.5611413717523527911;1.2918065263990350378;0.87228452979145421065;-0.86620019164148953639;-0.31867128577483444518;-0.29737899479338986142;-0.33087558299231029091;-0.12193113094151611375;-0.088150693506507102337;0.40618157396905746337;0.53404200520860500845;0.46977668240988690318;-0.93584430966805320917;-1.1358471360088677748;-1.2572452839821752768;1.5688586243878746007;1.7138290065335883838;-1.8672358669492390426];
LW3_2 = [0.99647927524704393853 -0.53504052197173723737 0.39838293804193875003 1.1091648910796017002 -0.41886662656164019847 -0.40094019443636846889 0.56982611283686723791 -1.1036209580954738918 -0.32400190803922734872 -0.031947967704594612548;0.092431364112963015911 -0.20541342536285231435 0.18685153955195848985 0.11365467161382240835 -1.2090379753442639377 0.50146565730697445495 -0.1471148475799964328 -0.20063623944871067373 0.31200834167331364943 -1.2262155867570692092;-0.20296811029684397321 0.055165678280978430736 0.28421384113469599919 0.18489717255442505994 -0.32625588050113846217 -0.40232757306452909818 0.72171615683551793019 0.9516760353834429198 -0.99578128299938073464 -1.1296892767242829869;-0.032338677829368653316 0.40531399403720086427 0.73318050732259065772 -0.93287939860723689822 0.36467938589440501707 1.0978640467008893289 0.60565454078311398156 1.368372485182684839 -1.0088167587305882922 0.93348801459789509938;-0.76620085393869430401 1.0405023277215881272 0.17085104298374201304 -0.25086913894975304551 0.82915892994638995539 0.2941581766495658945 0.24911751979921215039 0.45509394710772410608 0.63379410015644865872 -1.1539064489250610013;1.0353652742291614697 -0.043610685255591932763 -0.83845078057009014838 1.1976024403191367629 0.126811772337398182 1.2842871440330305699 0.7892579136330711842 -0.63495966727761143922 -0.58505172247766412674 0.25378310877162396642;0.4531074188168416339 0.89001966857273839828 -0.50927663304391257437 -0.56143755759567626207 -0.16028621112550744954 -0.71655987251028385732 0.23630711288676597981 -0.77183433264036738208 0.12948253197134543258 -0.69077471336469509211;0.51542334677899059869 0.96118106230718969307 -0.70585198983879549051 0.56089361985768626528 -0.57017138831770519669 0.14791560691352775847 0.31588785746016723177 0.24796299050699005528 -0.074392368172800912851 1.0996147021768183372;0.78256064746535514143 -0.77276490986311274778 0.35450743530310119267 0.57371140177890400658 -0.32006500744556187765 -0.23733931195790344826 0.16857226191266991289 -0.59666553879193962029 0.45376615847786799796 0.11090423380609110149;-0.047460042177910784222 -0.32411673865124640548 -0.052586723105668399525 -0.48098958935322549957 -0.94062846719474091373 0.55295629538787460788 0.5802805944370877933 0.56545977201034580695 -0.95508784769190213648 -0.41602069285109355423;0.2535282519619216357 -1.0694249331568972394 0.50407488165256852941 -0.29927274372030099325 0.00082685024323576579788 -0.41877901569122555347 0.68646536030091931391 -1.1248229288509477009 -0.98493861848366781597 -0.3605182729261688368;0.16781014183434625475 1.1005261359172195945 -0.19575846353845338665 0.48383687843337347401 0.71771141663330650928 -0.73740717150250134626 0.33890083108005397694 0.29010368214563753142 -0.60057457998032515167 -0.63168590226137888433;1.0810722413902726924 -0.28160492467372483238 0.382673208601269077 -0.28153129980061392112 -0.54105409974642360016 0.30658840218265803745 -0.51388489830037953343 -0.42440556776895582702 -0.56855297900443835246 0.79455075280288545159;0.67387927470328801149 0.42799789217033312738 0.58728420768988753853 -0.52400996949054734486 -0.17399165060321261644 0.55763602821244206975 1.1977010695535579288 0.072827684485425370209 0.35801411763922075249 -0.64843565162282967851;-0.61966855698701484023 0.66009209635337173783 0.81835365942891558078 -0.69817759275000990105 -0.52158398243926518134 0.78611984577432680865 0.59148984734287934906 0.82715801340664774077 -0.6932593924886377712 0.8269606784048482151;-0.33450390551460057464 0.64283388588477197167 0.67464885721224743254 -0.077287184799346153596 0.39858174365755966173 -0.053696280832768887581 0.18873357999308398858 -0.038410905210742952998 1.1268829122074301985 -0.66014184220192151376;-0.26447841870963856303 -0.58387585772543570961 -0.67649605820196967443 -0.71953160358820245079 0.09405893097552101012 0.051410512493899288011 -1.3029665835907755511 -0.15277234027242442282 -0.82424379118260449051 0.48095229283194090852;0.62725414400747159238 -0.6291622668743014346 1.0943406843863277 -0.90896438328377493487 0.76357696031745070364 -0.37660760085237654504 0.70416034137668404025 0.77842472931384487644 0.47337917066841456171 0.18890414084218884461;0.44336114328559400599 0.65733064076785430174 -0.51578062168229865669 1.0942254909565716225 -0.7184759926317962897 -0.36185822259239480703 0.18599569754503625374 -0.55773013267132731663 -0.66456353136518131475 -0.13527868636307135985;-0.31493858939955532428 0.18945182024603285376 0.87964477925555983884 0.85331154423022004263 0.65200370035861765494 0.68006174975378907988 0.54647248003556980755 -0.82286055172275329728 -0.34016402250698157816 -0.18930622955580059252];

% Layer 4
b4 = -0.39364242616507344463;
LW4_3 = [-0.93092304750961307747 -0.40406496402477010133 0.7401404812557590418 0.55418952127589282686 -0.62386471541600652113 -0.38813192681598862599 -0.86821320598471818375 -0.3436259037143266637 -0.54392249512062718075 0.083736558202184369071 -0.40874445345358040305 -0.22259371937089997284 0.26715469464303293057 0.0881227808178264016 -0.51472434130193001067 -0.44407869966148172391 -0.44960691747599579315 -0.40449122450970798059 -0.45221622942273365098 -0.17458650934557343182];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
