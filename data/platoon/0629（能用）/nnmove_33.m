function [Y,Xf,Af] = nnmove_33(X,~,~)
%NNMOVE_33 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:53.
% 
% [Y] = nnmove_33(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.644786415382709;-2.24855099234896;-0.581789816284725;-1.89546903030855];
x1_step1.gain = [1.42933908693485;0.45598879896227;1.88894161457496;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [-3.0448434883326385147;2.4486343891247916993;-2.1509408996732677366;2.0072249000272437414;-1.8306773120435362312;1.7036523026884968779;-1.1787862624846139337;0.5208483941872086298;0.55218779396634798395;0.60424554806694041886;-0.35961486517580554256;0.43595470778141093282;0.92659527801564123273;-1.3268201432132358253;1.4175903927106578983;-0.92251656707320339734;-2.1348607194143518484;-2.4914972120022720325;2.6591312034605500969;-3.1611210301286716273];
IW1_1 = [2.6048266842349527828 0.46953808068024982525 1.2221361113891482386 0.34654761735392969335;-0.91002306035514468618 -0.11580521817684313879 -2.3173341565092604455 -1.6105123038855466699;0.54808328034759823399 1.5822615546633085337 1.8859710301778289665 -1.1073362584156198896;-0.79651366351237873342 2.0466470817777793201 1.858201455224838039 -0.41701736640415087987;0.46749437406513855153 -2.2337465689169850869 -0.87283673644688442028 -1.0548588861684207174;-1.6724304077963891846 -0.99596855274761197929 1.7984775194130020459 1.1815926392628561814;1.3708918345412350881 -1.7495352682741569517 0.22460709037151371792 1.6947221790481126202;0.10417333584393452528 2.2704987175277180356 1.0655533070990224065 -0.12959063273144677542;-1.8430553813163474963 -1.1579546038248318407 0.6769701203892961594 -0.71915898236646835784;0.01041192843627471859 -2.1338243213890355499 0.89452757587164621889 -1.8950717442119950906;-0.52928942922346178257 1.6001677760540002904 0.26637903034537641078 2.3361146329954638468;0.96333397421017585849 -1.655749042159810891 -1.6899435144609991077 0.039473047566419235122;0.52118556840304408606 0.26995965250303782801 -2.2815125470904007443 -1.1203445198445507458;-0.6281550768774641913 -2.5608183776454565006 -0.31561691817137216276 1.1139666065810578388;1.5196087490774818907 1.6622756664198421461 1.524784420489593284 -0.67228888967768085649;-1.4773240661795890016 -1.9069595082463297597 -0.025997143339961878428 -0.88807124750045451922;-1.3593859842789222103 0.043195504273712298504 1.9812291157905577155 -1.0213328147496816278;0.032922829510587385549 1.8810566902526606459 -0.76392624980571732785 -2.2205342475528828672;0.94804414881043563845 2.2040284786624453339 -0.82692699095145538735 1.4822701145115564358;-0.51432569405708550292 -1.308442810716168303 1.5823204465006066588 -1.9251157148917354966];

% Layer 2
b2 = [1.5580177824874386072;-1.3462580553810792328;-0.61961735356869840352;0.49044514529172372752;-0.22545913449824631081;-0.25608287222135533989;-0.6257815187410320501;0.78888833278456893527;-1.1241015990294520588;-1.5380850595116297708];
LW2_1 = [-0.22844909661504858578 -0.4304734652010686613 -0.4918559500904949866 -0.15796407342383289585 0.43479734483497656239 0.017320976573306431923 0.16065146801776913899 -0.50406175612436443512 0.12898300145147528761 0.41788590444668682888 -0.35145419022162893707 0.278467182174401362 0.47525554070792758177 0.42498341644045017906 -0.35166488489487091051 -0.4040018760196417702 -0.016690099636919246417 0.48106423467436049135 0.34423595651812410878 -0.31985341654751020535;0.22255884429824765447 0.19553250683099776541 -0.44907412237140514888 0.31172523766427601144 -0.33269845304131923092 0.59362542874774604229 -0.24606771183394557378 0.39971137146569651888 0.57656801759511111527 -0.70372546510994304914 -0.058761745048134070291 -0.16582658892030172071 0.05969684244188420974 0.050626181004081262371 0.2432020099895234877 0.34047315477837902797 -0.46071786818400622954 -0.092830548887758115861 -0.024601629076773569998 0.32056891359178907308;0.43763201290226660944 -0.4986404770346556381 0.40216860365985801495 0.28264485867882493952 -0.63155683533590867285 -0.21320463270941852896 0.034671610368955461945 0.49774624124359839739 -0.19564445521785880922 -0.0713841435375485861 0.29621055592300582493 -0.33308185829924791266 0.088449392626902309522 0.093112278014729502051 0.46726995916411395715 -0.34534479106757687283 0.25470148014765214839 -0.011653608214312745697 -0.078354767242620027012 -0.61073855054251757757;-0.35186420471298784918 -0.43901735032861521901 -0.97513818665907203709 0.18871681247639038315 -0.30980692020575995027 0.15932585447705971404 -0.21176062148522384332 -0.5860009630852246465 0.40360482365305960784 -0.20637222878313818408 0.28849732853686810286 0.28741005429510085856 -0.32776287071088422431 -0.28910520164461694925 0.21269049050096675013 -0.16128929216683152159 0.47280068401981772963 -0.12639323954881243051 0.29478586991057353917 -0.38742335172920328024;0.22317367620172104403 0.28955276222953596488 -0.11476933932384356107 -0.44514261777000757592 -0.35238034075171331683 -0.25453285187161817094 0.24110824178315892752 0.52870260953835435114 0.48812639175206612441 -0.16812578900904695534 0.70377410333209200477 -0.057588727551324492282 -0.12072443077834224545 0.34436537810308359697 -0.16362656588440196992 -0.38565311737760560318 0.52896964573078641969 0.37372807091701010229 -0.50734384596013160085 0.45686477132888425601;-0.52480896643204288932 -0.61167175268633167118 0.22200260953300601785 0.13795514785443752093 0.73057815293755767883 -0.5325530621660885533 -0.63400317234218950269 -0.3663122779389575423 0.071813082299052713453 -0.20988485579541057979 0.10602541980608455596 -0.26647404525282819554 0.013033762076420152276 -0.087278411232579788948 0.04095618011362694294 0.30543791368949840814 0.44189231483170188231 -0.43129792371230168957 0.44895460376940177216 -0.21724675442105390033;-0.40995711325660011415 0.020025946290088379731 -0.4005921373808959407 0.26852624914723005611 -0.20133099170081519835 -0.42909464686016990376 -0.42506045735552344667 0.44173262692603898483 0.29552469443741841149 -0.56751940503409181726 -0.0040107836785034552129 -0.48348557252792623284 0.15324699841330627348 0.10581845939648530652 0.087475036240074355298 0.36171918052639590035 -0.40010121569233880745 0.79990703577933452983 -0.10092157705635268483 0.73138141585140992174;0.70008194309910487529 -0.28016169684874875356 0.26486187637163538522 0.26765923410290154427 0.0229604125026714595 0.20739496892593822785 0.15358681938531273947 -0.15826102203975822569 0.33539046054896953786 0.13753927837203994144 0.72018070833507863426 0.28817574181920690979 0.37737974856700789994 -0.45155603832347573912 0.57962347379766354649 -0.037144786562707497735 -0.099520508516697317458 0.21159272574500898045 -0.59953437639178730478 0.60380710810902149532;-0.29829791672706645889 0.64183206994533803513 0.23571963029331183259 0.34830382304100854229 0.1398396699744736682 0.035914063838045795496 0.21795719612883845961 0.90072281514358287779 -0.30412251180837795994 0.082065185348030963985 -0.0040099964081819162651 -0.35285366748990204533 -0.18520270327225393792 -0.11044010870284048931 -0.28134721072804663722 -0.12332273461046963647 -0.35373402657873831423 -0.39532055787062769792 -0.17613992630244873494 -0.15443608776622752554;-0.39657763184268918222 -0.11763894267038467467 0.051077298349284816492 -0.23623788501163728304 -0.018070766283553890696 -0.4365011545855236319 -0.26171951013468963687 0.62582891358727643638 -0.6507683687919428861 0.17686281710114876153 -0.19584858517906306163 -0.041954740557531594591 0.58220666694539802144 0.4842984317810826167 -0.45869722999638767869 -0.4107327012488822815 0.021582540505331537783 0.063941228223374002582 0.2406383148560618801 0.51734384222302987055];

% Layer 3
b3 = [1.8135771708146002368;1.6907517078370868369;-1.5102834204185144884;-1.3601151151117651938;0.94976554160281834172;0.83205648768459627984;-0.51587770391436871265;-0.52571694765820697892;-0.077033889835206953434;0.42579066281647331982;-0.15062980795993102801;-0.33749683120412560244;0.49306948180587284458;-0.91401086280719667787;0.93126639125285048948;1.3289942141904595996;1.1975381148544905763;1.6770351697774465993;1.7373509482426414685;1.8781207467685523405];
LW3_2 = [-1.0816138496110672129 0.38907274707958966475 1.0874313222041540605 -0.028995458544549389951 0.43909436185990119439 0.17038011339362107988 -0.8279349275985333767 0.55907505801228996045 0.9380259857692384573 -0.51340028497200840274;-0.37853303733903626016 -0.53941317688475964864 -0.64031435623525656542 0.017748860854036492551 -0.25265478331932228473 1.0327398290878277987 -0.74310451268898380928 0.73496374431108990599 0.73372004863643813799 -0.11095958751660740804;0.76987950992536902106 -0.64255702372229817065 -0.19149136930097407361 -0.4363682628437826061 -0.78827119118243271778 -0.68661784946770898497 -0.31328026356093124916 0.53394962608658191883 0.75587186626549651702 0.36170435387464461297;0.24861617597581123218 0.36657881822794030624 -0.074512801207810050452 -0.76214924123093163999 1.0495999725793057067 -0.97868290971882720974 -0.49848010249999236132 0.47772285944008480163 -0.31687557363381191333 0.46580313651710175682;-0.14133574403776918982 -0.79469838747916021759 0.8422737470945942384 0.3710317205410346153 0.91940834194792731004 -0.59746464805844978763 0.32857484563239841568 0.8235672674742485766 -0.64235733297444574941 -0.11182589554561767065;-0.61098155989541158561 -0.32275238354370866523 1.0590625880990236496 0.37852274363056542805 0.2557633968438694505 -0.40497282104879578357 0.34442279934006497788 0.69614843908710843934 -0.91567875943588572518 0.33658029172703401999;1.0536412394609255827 0.57292381765357558443 0.15965141431024387764 0.65146188972078200585 -0.4588171767577429172 -0.81195228116610607128 0.10633176867102935026 0.71955890322362081601 -0.30356765907690858031 0.8247328589795704934;0.2190588188777960188 0.24233223359797345653 -0.3121899542283932405 -0.40590568771058610498 -0.26256553787589648197 -0.82301871624118327908 1.3102502316728530385 -0.50886362008566832227 -0.46924829110173899016 -0.50136821951589960467;1.0714242350910818669 0.73616719530220520173 0.39157038160371826496 -0.76614648613328628635 -0.10554660737633614342 -0.52066568358909448566 0.46817530518014799368 0.51691260049723608549 0.67909409251756758241 0.8488586689818345965;-0.37049790312695746186 -0.23730503895525981162 0.52207984089201919797 -0.73403486814480900513 0.74132302515854431313 -0.22567699194060936163 -0.76183131216925881191 -0.8677842062883757146 0.099275828183314249187 -0.24849818877917292936;-0.57770267070083780592 0.35128530624342096944 1.1900168781076085889 0.59417483089261691198 0.27566740585574139866 0.55188264669637743243 0.29882545763028744989 -0.52318746312769404128 -0.63834878191595989527 -0.074469602874810927884;-0.47300864099867040435 -0.54901633194659205106 0.79527526304262952106 0.8444967789485295917 0.54272276799037788564 0.38699150892815398217 -0.54487734675243548743 0.047831765910733979597 -0.8059192976791637042 -0.45211320573459379268;0.57095215606970350919 0.021762897184524253313 0.69979691279464406595 0.97195728463087160964 0.93712938059226547072 0.42627163118213101667 -0.14215424975143517439 0.068964630207870858403 0.21150859231823379569 0.52678288755222646422;-0.37067953659988805981 -0.31470507529142649483 0.16369025128230255128 0.51375143718912896773 -0.73243026618739859313 0.67559181737851525806 -0.45424058034318953725 -0.43548975778819570825 0.60163174742255975946 0.91374820578079718469;0.26588853774142828801 -0.73621970467359043599 0.33764456518932073337 0.86913237178407765082 0.51965294956749397137 0.95870409982842041963 -0.077638109403963581623 -0.69962484045222816942 -0.50188910418839682848 -0.081780542650397927695;0.2911710645971780087 0.53477947585530372088 -0.91127152790613896727 -1.107183786905652001 0.5730741403829296976 0.45177777806426777651 0.12442032891059875976 -0.35980607061471225894 0.68354538616546056673 -0.2958418388405067434;0.36646949909092663145 0.51666411378796817111 -0.058978673553176694244 -0.30533789559060003915 0.71424341381842881837 -0.86609880840309505512 -0.46917127281633058677 -0.56074341502530067327 1.0386022496348676913 0.36074615528633346972;0.26768945027882984355 0.093394205316990483445 0.071638814198932004862 -0.7562462316687116326 -1.0108341279331574114 0.16623558783174219311 -0.64883475012108671187 0.34160934954150468101 -0.93908562322936139921 0.3860340168682038775;0.60746427578838779748 -0.079757821726053390599 0.42059348436015947525 0.31582387367556952196 -0.48550137560321288133 -0.56924089837797631208 -0.2152528332350240603 -1.0221789572738784191 -0.56122081711337945542 0.85202019951816465593;0.96678901690501828359 1.0390657032192807119 0.058674500405746107812 -0.082018288742679149039 0.10363632396327747409 0.42264143699268269527 -0.31248924855384424548 -0.32931969733331167838 -0.29049895406522180386 -1.0695855562745237854];

% Layer 4
b4 = -0.27016566306775308126;
LW4_3 = [-0.53502566136807827579 0.61939950770607432595 -0.052244408593276364661 1.0504968445646605257 0.35594169719249302286 0.0069376675802323567455 -0.25992198580464953572 0.37142460729343867998 -0.73086526844105292877 -0.76854406541305242406 -0.72545840278506112941 0.072146566365932515708 0.053104313452183637967 0.37202237907267260431 -0.45111173293023792974 0.38660756081762437386 0.46141510566495319567 0.30265611304310652274 -0.39249437667997816304 0.50293160382971480171];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
