function [Y,Xf,Af] = nnmove_20(X,~,~)
%NNMOVE_20 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:40.
% 
% [Y] = nnmove_20(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.581224840168548;-2.08798180279202;-0.533403245818273;-1.89546903030855];
x1_step1.gain = [1.49735732495204;0.473316379586819;1.97939958841911;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8873718084508226411;2.7931431920368909871;-2.3405057069136190329;2.025078008812660979;-1.8963950903582180718;1.7240075499723055419;-1.1154084869124962776;0.4902731775288605709;0.17542651598030234439;0.98045884190473309161;-0.23974143781581094825;-0.22304228158037214813;-0.83833728806731377947;0.88103395943586426675;0.75632570387120567901;1.7417399678656819706;-2.0391907567920357636;-1.9475643237047808309;-2.745034429176214541;-2.9013024348599754099];
IW1_1 = [2.4548429862066694085 -0.17685130805915830199 -0.75232501404436347148 1.5586512705446837757;-2.1389883626449637255 2.0663533552876960364 0.33523300006582640309 0.9080460102593924665;1.88095517334291773 0.22459101846897108756 -2.2164584605108963444 -0.12543334772375328012;-1.1526102883833395651 1.5439548628341575043 2.0776902599161419793 0.41826913902885864971;2.3794734608831835665 1.2735963470613422821 -0.49794104912900843951 0.3844426156891356805;0.12996800421351761834 -1.7835175310397897164 1.8086616943626998566 -1.0955517526457076993;2.0675197926866446529 -1.8873604144981039887 0.21531386529199972313 0.80159073466820895959;-2.3108214633823691564 -1.3510960495059389785 -0.47089308773914972939 -0.26232467773702239366;1.1058148385292465576 0.08525902466398797841 -2.2237623150583734066 1.0807908009906650459;-0.70455703880287590124 -2.1398560980247491869 -1.7500010948040682912 -1.0588877912098819678;-1.4929307694164781761 0.70455140136828153796 0.70152595377888526951 -2.0875473507247903626;-0.31737747619021161594 0.83951328797488922184 -1.6755995484919521399 -1.3177067550379768512;-1.6741559762033562109 -1.4422837230235963091 -0.72584137585646868462 -1.2025058432397088826;0.68320160891385717239 -1.575052333051380149 0.66038120313391623917 -2.4201710431992804473;0.5073168019443206056 2.6018931595597738493 1.3463909424761792977 0.89599389127009920752;2.08898183032424134 -1.0347523152031183891 -0.18619816025818172744 1.7182380569704815976;-1.3899400807135753322 0.66117513381421844088 -0.93657179736917672841 2.3841632525628795314;-0.2262007591963862696 -0.69971069119818252169 -2.1822279137881466227 -2.5885277610070174248;-1.6430314219650519192 1.943700197554304232 0.52187764736834019175 1.1859010142823773748;0.066766878737422818979 -2.2379299245922981143 0.29073934613256802173 -1.9955133688830475336];

% Layer 2
b2 = [1.5413309101786378807;1.1175677268417700816;1.0559533425978737675;-0.59090270182126969356;-0.11031632448531383806;-0.22541650581151956301;-0.54410343713194286863;1.0275515868665050512;-0.98764256326660915253;1.5102978308119976436];
LW2_1 = [-0.10787671440030544012 0.68889145459736944588 -0.39980593676309605922 0.45277148843534653633 -0.15603131696090632996 0.031113543832112438431 0.26448810949719298025 -0.28358159919102821078 0.17258833347316657192 -0.2097727565211288947 -0.14191258858865249404 0.057370922106203078861 -0.28373860087208474523 -1.0273762135796906669 -0.64725661945450085888 -0.80567492093583681356 -0.28520092757841725151 0.55159211725080536937 0.33261476803817974224 -0.59014675852744757911;-0.40812787746975720538 -0.21413454742351425986 0.044588270707434270179 0.072888414184359401338 0.21761325606338632888 0.1379882093128344811 0.0046346544946168320711 -0.14351725853086627627 0.030494798241539576578 -1.3283913845109063256 0.60922904006684119871 -0.11156743314660226563 -0.68640282579294320531 0.31558993529181506021 0.35830256509282115696 -0.28956192632842575607 0.30601256413774458043 0.49118767744732128033 -0.29829545650754840658 -0.2064479102940004196;-0.74652924153683952735 0.20542213825999086629 0.37077580136506410602 -0.49105370458999675343 -0.14955491735730447322 0.12591933583309536382 -0.089693954444665963122 -0.78679204177790795782 0.26656383820936691009 0.42150729949824533582 0.16881791437385859633 0.5508048624924645198 -0.44825969526801379139 -0.6804662368336471534 -0.24255357369066452011 -0.49186997370139562413 -0.30922567033500109046 -0.61216164777702508637 -0.10822680463420701613 -0.041770656395503563685;0.11452506261599040838 0.37740293262788759954 0.20136085109980361718 0.1955918969060093382 0.4076825992786493047 -0.47764355174678391203 -0.24358695738309726897 0.44802812929746166359 -0.75175406279371770335 0.33972116140721492217 0.37203617992944215676 -0.38666230789721139915 -0.71832208292999411015 -0.16793170947864341502 0.8612235117437019305 -0.049477850536794348857 0.11218022939160032792 -0.76192602615638949093 -0.24413870990557209883 -0.25861208299742188821;0.091360528292356593671 0.89755142543268506827 -0.17066598500639532099 0.39095413283944568938 -0.012646062942140445101 0.45634444526443396217 0.17150734585649227149 -0.229002730412232125 0.082560193066525289218 -0.74390255311441733088 0.29580815796943316087 -0.067143710666978315138 -0.022153619094213254648 0.25760880758519622002 -0.1824467346487128605 0.18244805272322334178 0.095460852177562394161 -0.15097683276367529492 0.43663693646200718579 -0.45484357507310368973;-0.16717131690073064321 0.088532191257629830328 -0.45471025123395636403 0.49845958851792038224 0.48129766348928709752 -0.37008045610398604408 0.093071750423562707444 -0.48135995089177130435 -0.12042929160250885612 0.063875482878843314882 -0.51253951599235292313 0.22729798239445042629 0.21490189429262068765 -0.25683090622488607968 0.41685978541531015784 -0.12589667137731200275 0.34028646905043102855 0.64066325759495279524 -0.33259425785632568129 0.11156714707363353523;-0.53897057686569393997 0.31728508496222351809 0.32127819413271235804 0.34579264230554196402 0.39981701720943491063 -0.56163751201780620637 0.27945076061127299694 0.56428192478398797594 0.33294578737121871548 0.38663770469055797063 -0.43004823182828993966 -0.19645231664841061869 0.29363979094235348466 0.016823559520491870173 -0.27747136230796953793 -0.012911340725300757271 0.67135327813621736848 0.00061304247959992005674 0.20520760190966980119 0.15816378504021072482;0.17387009754940138673 -0.39371327082689949739 -0.33475599968908653636 -0.077662119579682498127 0.57093929489070771588 0.58139399755372289658 -0.31018044950155659878 0.12167793712709204512 0.16008204016793797786 -0.83337823542116307163 -0.2404765038523320464 0.32205220028044401204 0.23589606267583773658 -0.613980943141327562 1.1127448707317812993 0.039412769218888213385 -0.55926529636812172264 -0.5988487303090576086 0.2591257046844488432 0.080293753492504546521;-0.21571582033040614945 0.62738013125254954439 0.57495420116261342081 0.20312287245833479665 -0.11417646800021764852 0.68040644711093711816 0.12116116209484656396 0.14577254809369766253 -0.33766446725100668358 1.1836852174155465534 -0.40834885493938144485 -0.31620190454880336972 0.24555622321079814685 0.32758708285756632517 -0.46804417265461079056 0.515966042549648507 -0.34987250401166036795 -0.024365952889841085982 0.67167283133271404871 0.12677776128354745211;0.55121716969239153983 -0.15887733467221987205 -0.46334582412949348873 0.035077467134189133091 -0.73086802538609296764 0.20101426551728973635 -0.22364015091388300682 0.62909846334449837091 -0.12581831284587621789 -0.24872306757923623444 0.3852429493638591107 0.48834340507957496591 -0.15631242592094393706 0.16494288396763168159 0.21965917866987402784 0.13707023982869692702 0.41773571697494221722 -0.3345674165047743398 -0.29108314742471907977 -0.040887573176470640157];

% Layer 3
b3 = [1.779972658831943777;1.6106088260117599198;1.4809940143185418293;1.4772058955534692615;1.1198534828449258072;-0.70838058101245759968;-0.48172766956463664023;0.54650337327715270419;0.25942249010465806558;-0.058114954013809130839;0.13078616086342981228;-0.15460648755525724374;-0.48703063278784114454;-0.66622139405468316919;-0.83406095305463012757;1.0957092634853724533;1.3015518240629575519;1.4851696736878849947;1.7362593849330985041;-1.8926971078085774725];
LW3_2 = [-0.11437696244878614582 -0.65826143630356026559 -1.1596769528018049389 -0.13258113382773123456 -0.98356528594150760547 0.39382705610906132421 0.012177815923756354216 0.92079985156033483662 -0.53913935819478420175 -0.034345001945339889704;-0.91579996610974467863 0.65708833996277293821 -0.11235517446506861072 0.094682329067764206543 -0.65848965951755711323 -0.25119447079466961092 -0.53025116875839384267 -0.62459193639897581107 -0.46172279447215847092 -0.92293878226162340273;-0.14786477159075919752 0.42567333989607247791 -0.92567352597084062715 0.57151553244986030844 0.34108315946289952114 -0.79943035755019475896 -0.23004570893635833961 0.30701002897816670467 0.22540640640710368769 1.1050217705835239101;-0.56053544166536650728 -0.46978701303897502095 0.085296863958765678504 -0.52032589145523155949 0.45687000413439815549 -0.18836696195014343558 0.83018919090504017522 -0.20978349718181579786 -0.46145183892722613228 0.059644464770219875194;-0.07647856301687055991 -0.12344695293607307884 0.22326536238496733078 -0.64344255646663850445 -0.050948245098075321813 0.78922030921832031503 -0.43520930796276002805 0.34576349785862153796 -0.37425130146216117888 1.3790915503600782444;0.69657955563452533809 -0.71732901364660661692 0.36525205505560037755 0.94182620039088837949 -0.37348915523747555634 -0.45683983011467133029 0.49318180146716183998 0.51717304226279570134 -0.34193520671426969049 -0.36022428756024599261;0.319210107015545419 0.87895892009624188024 0.76160695897818264655 0.65536824645039559734 0.36620593517456900834 0.28109004905755519133 -0.94973926093327021292 1.0352600525807846843 0.47661023372283067845 -0.088685624981324998051;-0.75982092711728332901 0.65300815662922062632 0.13857391721926243244 -0.2235233006030434566 0.5921726222887722102 -0.66495585135973922508 -0.61867253264936028501 -0.79396997568390037525 -0.69608537383066615423 -0.37313437946819966173;-0.50797743011774765254 0.33425245537497633164 -0.87352154928286729341 -0.79111748008739279925 -0.67382194883132795482 -0.14511053898866241307 0.41247658592658281718 0.20511901930417231199 -0.14799549734327241413 -1.1002646160945526166;-0.98062524960648189687 -0.56958435947722907411 0.18399970931648518269 -0.124745576686964732 0.62659316799546915799 -0.69720989277732769995 -0.408242858085772653 -0.18541010076485126001 -0.53540532396706086438 -0.93783732345234749328;-0.20455923296309072579 1.0737365005040897525 1.0351167416076616501 0.61941261788867818527 0.36540086851197567386 -0.75056680189241220535 -0.31219414091437602821 0.0062752352568716911196 -0.53103661352861708522 -0.16045454218973562166;-1.0868355437791759055 0.61933405440270072884 -0.072486688127599188669 1.0750439573995469456 0.31536287696292286675 0.66118350358992727944 0.36788440996213378487 0.052294587739161249584 -1.271372621717014928 0.4112928225753702538;-0.26885243612529763357 -0.88598453538976751354 -0.98263317790787763073 -0.62452930284809926587 0.037838914937593302878 -0.25533443099851566016 0.50690718385347510733 -0.57903214411885328694 0.8229950805641685907 -0.50828612727236510693;-0.67142648855386277695 -0.54680882086911519746 -1.1002944808053680692 0.87744982043257857551 -0.45823582028964654489 -0.1279661248442644228 -0.62329532817357147234 0.043570020017496623177 -0.14100179416998381843 0.25188488333854874845;-0.27242356192100036782 0.21346697953131149594 -0.059866905288568694754 -0.57487163109860817123 -0.17866507731317515795 -0.98146444890731121546 0.45296130517218363698 0.86168650990220696517 0.84567607986491599714 0.81875659139885470506;0.46837597766108851616 -0.56700819351203934904 0.8331373145225611232 0.76131536485465378661 0.75746272503275913213 -0.61562664965428126607 0.40967618074493544755 -0.077367471025287265496 -0.7355903333780144937 0.28503460519607648482;0.52720264844627884315 -0.78805150085402220217 -0.16409607350132843218 0.75225242886988830104 0.67967127805524829576 -0.73376362020379870543 -0.51091445915368416397 0.80634449876063196694 0.39260146222292446883 0.015205526230428059037;0.66255069458722493092 -0.46354587997535290356 -0.96184559571574446135 -0.07846268090720931454 0.71415431011748542467 0.48914362835472280366 -0.42341852475165459024 -0.85760289723090643577 0.68769510444525694393 0.16379852277317427656;1.0295492949218316703 -0.13261521536078535455 -0.42353558717705147574 -0.47152313594538602937 0.18693641476491459907 -0.11708654034996056337 0.82757158927442531215 0.1630298811414720439 -1.0858897586890827736 0.66593927564432020549;-0.59358892058227141764 0.37970997455544225341 -0.67015289339992578643 -0.61836463301341715315 -0.63266567327051825842 0.28680842944580692278 1.0029691553717077213 0.75177902117977513097 -0.25105360425171119321 -0.34793570487789327039];

% Layer 4
b4 = 0.65390340816437675375;
LW4_3 = [-0.34269308228538392092 0.20506226715126568694 -0.74109072876441994815 0.67538358470382497956 0.37652933989666742542 0.28726318804603617751 0.31238689205155933948 0.064320120180238873897 -0.14402028472276059978 0.58823033619887599155 -0.71968349558779176611 -0.85630695531284595212 -0.22732685538541921866 0.042019842726601058791 -0.54205585630231467587 -0.024391896908762953494 -0.45228344392695551957 0.90103945050708467157 -0.4245442180280296629 -0.079402278230422326799];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
