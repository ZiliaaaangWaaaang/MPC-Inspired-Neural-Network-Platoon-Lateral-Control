function [Y,Xf,Af] = nnmove_18(X,~,~)
%NNMOVE_18 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:38.
% 
% [Y] = nnmove_18(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.581224840168548;-2.08798180279202;-0.533403245818273;-1.89546903030855];
x1_step1.gain = [1.49735732495204;0.473316379586819;1.97939958841911;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.343301187085121029;2.774213006591955466;2.2853746414659399377;-1.5039943381165687963;-1.7021425339442139979;1.8584457640538389889;1.3649880732595227606;-1.0911974133149919819;0.40569281178490751438;0.42092112618967814086;0.4738670960713682323;-0.34152728376019625411;1.2585723763679466103;-1.3261239313954631402;0.6306247542869550804;-2.432909817587125989;-2.2682629868542485418;1.7290631870817680937;2.553869657168092111;-2.9142712863338200435];
IW1_1 = [-1.0873023612536858451 0.64234361305024223476 -1.0871197063515527503 2.2691352252954293256;-0.96327073188069900489 -1.6039877706933849399 1.159269747499134473 1.2091657388152299291;-1.3463277446247920999 -2.2966832639397090077 -0.79646214137018533918 0.125934450416690491;0.46527531439181091244 -1.4740871126474237585 -2.6105912322238418177 -0.92310892077748241125;0.67517480578677180336 -2.5297815589497933964 -0.12798763487301939579 -1.2918339958456126482;-1.833927045814214507 0.15349162720617656741 -1.7034086527770579966 0.71911177859567121384;-1.7275886436890626197 -1.0883573837154363328 -0.70020635847688372788 -1.7532997555482841001;1.2885594266838757971 0.99332132309241305546 -2.437568829926595626 -0.59688865927960865765;-1.4589462111514066578 1.0995218668239734594 0.24609592631383050976 1.5505561373607947839;1.6081508815410576752 -2.1044309976898638581 -0.44962610816241205258 0.71512795527699812848;0.79362058130462020955 0.83298094507838504885 1.8987834555856004659 -1.2470459960690598589;-2.2460563662183230527 0.55491479329517046093 0.010996623049360505775 -0.95446075365994897943;1.875948862184745991 1.1750379948536691099 2.0265391286117293568 0.78953097116569215252;0.016658094977477597154 0.54231148215297575454 2.473357017982453776 0.51011163493756361831;-0.025145245067579074377 -2.6964846730601603753 -1.1926412543061977178 -0.29801799748096824416;-0.6538652018428734447 0.87302153088870559916 -1.1965456353310446325 -2.3653654922341673661;-1.5193583377677724044 1.5866345376294663794 -1.115385430666637756 1.9971174633554809041;1.7385208587344875841 1.0116840560065836208 1.0555253406299101027 -1.8599722840723151851;0.52073029617900812305 -0.5909412436862111484 2.5903681428936744524 -1.3461846042300471549;-2.1082355098605489729 -1.0507686472766077923 1.2406691554076176853 1.4500692915425394958];

% Layer 2
b2 = [-1.5544161574908348378;1.1682808903197292594;-0.63364203673984820231;0.33891185865781409126;0.33061887555429908536;-0.26623429841456941469;0.64131802076298283222;0.8131954380121479975;1.3941363768061265649;-1.5717013249593951851];
LW2_1 = [0.15349696608491378291 0.44043238769923909182 0.11577737728624462599 -0.49275549514525274208 0.17114687864729530298 0.067981681486515663226 -0.26701644943120450559 0.087330528632787757237 0.56049582994502389344 0.35872157987176445104 -0.26136843905893025752 -0.53274298922704954595 -0.39108641024101198358 0.30548880091926872149 -0.19374150656737462728 0.44119212941701690944 -0.45705808836160283226 -0.56948171066027475362 -0.442184955859363793 0.60437617800596343809;-0.16335812959680148793 0.11344071441363771935 -0.41829476659578623821 -0.30520760849610056864 -0.51778685882928277007 -0.24224218483814469183 -0.37570752675840290991 0.14204003142579141317 0.049649211966052431144 -0.1782296408925359843 -0.022916896757132886736 -0.30969092670088166352 0.63695548119377165541 0.080187402901347196171 -1.2229722859342389008 -0.11050405878775748647 0.64289019972449490403 0.14911143748503452588 -0.49256799741916806878 0.063931792993634092848;0.29039170057752655696 -0.41432755431387136014 -0.18744867299863793297 0.7476432189856985211 0.5185102809003762081 -0.39222293118462292494 0.084034685629010133501 1.1329583365195399214 0.17976800794635489078 -0.48981547554970528147 0.78075699831656475425 0.32671466598275311632 0.4063076797266081952 0.62071327968802980646 0.079045320250132000695 0.26143970929787330171 -0.26739716985218497936 -0.068649216582287439503 0.5470881563466458708 -0.41899742994802879892;-1.0431849036405318465 0.27555382921476201386 0.11700173247664731602 0.16165886769888759833 0.33791653507415891911 -0.036528462407483586194 -0.152648562105395319 0.16680191297788021787 0.2078612022048834107 0.22345812774682147217 -0.75347640988172459586 -0.34884830813754991174 -0.35154380720468525467 -0.57327705902143821781 0.63788226736850861531 -0.21441667638441069821 -0.15996056291855870191 -0.39845762818503582814 0.5138146082504815304 0.59925343359443272728;0.045550877675728476679 -0.20640452478293327965 0.39201890363395447414 -0.58713845511028894819 -0.047954756063861826709 0.25041515907246447714 -0.06032660082232121912 0.069384601057976350025 0.063599060721353781189 0.4837804986483840719 -0.40492004406649750869 0.052478827036088596114 0.52828062452534096938 -0.22249321443421885003 -0.45892632211218420402 -0.41935814487594336164 -0.81005028361745390342 0.5583588441277197445 0.11016550270418171142 -0.72534682267004635392;-0.20684353605713318158 -0.23270600522628656637 -0.057078414956239865996 0.40372184589496401541 -0.23699717591193447674 0.2452579041906273738 -0.15994021704707669929 -0.73866700789548578321 -0.29023102406301021228 -0.14552696229679648598 0.030508758890717982415 -0.58512044504699511904 0.5736176612457015711 -0.25112469064582232381 -0.51747086400702679843 0.25906614598369037683 -0.18019593924364063486 -0.14031054626209973901 -0.58556021521787982032 -0.32077072389024396948;0.46487051934572554135 -0.41563989127124323364 -0.26765235276224769168 -0.91373901498011134148 0.45116992813788653338 -0.15602001276262789098 0.15689851790275693988 0.33169440256024029789 0.30432772888095921404 -0.17460884694680531282 0.64523475408582331436 -0.36589823740802823737 -0.20760437935823483624 0.42151985400070052235 -0.54312492749585961072 -0.72575887832763619212 0.7345518239333419519 0.27383037976780338907 0.36240585622222487583 0.19856281447636847659;0.89608837572802502169 -0.2770138497320943638 0.15601434188656823632 0.18519033304342902291 -0.13596230136806600197 -0.23963040252737374813 0.011595676842031776843 -1.1530821455511588436 -0.58015971669884380812 -0.57542389426194429092 0.20425752547150832772 -0.004717084404730891023 0.27477863239509414672 -0.56424433452263489386 -0.4611582418229972502 0.75303103035233609486 0.38654018663970218794 0.3439664766783949168 -0.29115728141120111871 -0.029610223465537221371;0.50340015739530064032 -0.098450189902209189752 -0.5944153526924919051 -0.63509042347640964898 -0.031454693191735341729 -0.10953531440523564533 -0.54850359305568963109 -0.26292629597996142188 -0.34615882623199778489 0.77823354441063019582 0.63364796382999832858 -0.10364057163043101373 -0.25096862774173839261 0.38214507997122953986 0.53294155168204315753 0.062599110140404035096 -0.24778662907583556829 0.16710985354884683174 -0.032012578240857431089 0.78876116431690712627;-0.57167971204329770529 0.57124655620999387207 0.13788008533472889683 -0.56545350296309171423 -0.029466816097227264276 0.22732507273609456333 0.12247024933281319692 -0.57431972116273655171 0.25432848981811229105 -0.093722792200998147893 -0.19012055836887686855 0.75959099907383698103 -0.27170442161724406294 -0.46103295445576836231 0.37731064529232932747 0.64828796363731688857 0.58226142949902126578 0.057709135823926095699 -0.26354759428421059564 0.17661612136339932544];

% Layer 3
b3 = [2.0978278905135079313;1.6877063701063301782;1.6375163786037572056;-1.3069278667298034335;-1.1436697292814672622;-0.98626989808593934494;0.57575581174268408713;-0.58129529990143380402;-0.14548717302401062423;0.17034728150879718811;0.33096633684790732755;0.3491261250753087686;-0.56073888057136567209;-0.68928157752355379007;-0.97101432525269715246;0.98641862791023093848;1.2084457678352331644;-1.5781079590541327029;1.6693130670939051452;-2.0002272268859515592];
LW3_2 = [-1.0817354070195748239 0.77898444107154496407 0.1335200464304253376 0.082596823638666827527 0.22560184564800850326 0.29578769848126468256 0.66762592750195226543 -0.47423979283218276048 0.59605125468455433246 -0.19006091820074641485;-0.66747599027033488461 -0.69108716878445242138 -0.54560990580779300529 0.63326536000412303462 0.44416672555795028154 0.68696570403273460315 0.84093508831692176386 0.10851189976819176908 0.71390136384104696532 -0.22967771910982145989;-0.78098340748571615233 -0.64642196991864830924 0.66765565299092954898 -0.51406458099026253183 0.32989401100030524283 0.70535324401417132112 0.29177907493156096663 -0.17866046615959635391 0.71970367566916626512 -0.27822323246282693043;0.14483469046125116431 0.3899258810083108262 0.88553009262548942893 -0.72684338407251936065 -0.59189136989458290827 0.81586638475532824444 -0.88180898686188713409 0.52515625127953968754 0.1353419881947541259 -0.19447510161806946805;0.15606570920277038073 -0.33739869143381451266 0.73689199910952207784 -0.87495075030718938436 0.87791689116481053112 0.098045098375960648696 -0.4525541546336843135 -0.78128602057586837848 -0.18133827423269960333 0.57142395609023988179;0.57661210817371788551 0.0017866562115814825507 -0.53890600772326058276 0.67905412810969678628 0.71393025816005140083 -0.5223655690016494324 -0.40542932769377892921 -1.306877253830770913 0.046871284897807931336 0.70275549273054249699;-0.74477917478798261186 -1.236386409438569034 -0.013208159516222176683 -0.3601290233689010134 0.051058595800923700647 0.47992311068422133236 -0.72609230198895280406 0.82496242258258822844 -0.0065815716755859808573 0.43120800862646990748;0.58155723270479842135 -0.018642196910840735935 0.76098166467740191443 -0.20137776672127058464 -0.85540988987368737906 -0.8745489409032350947 0.30984331372815965278 -0.91783083567882406406 0.44097428694124141124 -0.22236264115012410736;-0.039937711806114079005 -0.80952030069958158531 -0.18257811981366223186 0.90696168129162924032 1.1935157804554124006 -0.80648458739021511299 0.098151170001292947775 0.86659027229707408235 -0.046301892880998042623 -0.57598845496104367214;-0.12009493574405241678 -0.27096554869101319163 0.79665942307385384513 0.20926663495752209632 0.87654749680346599749 0.83380441654291004294 0.81136131485112605866 0.36589942898089844459 -0.38331763974180899091 -0.88873195108942559806;-0.018986891020226583093 0.073452659151980681518 0.38704416349683956611 0.88780822846371199031 1.0307100821436940841 -0.53678028820688905576 0.5337200859030450939 -0.49298072735421993862 0.67085502094576865417 0.66129423581769475327;0.77798021940105677174 -0.52644592144381618937 -0.15476524933315577437 -0.025513080561620271602 0.16117312816339329773 1.078803433527682154 -0.20444133146459342321 0.40744555641904428578 -0.71549300019397432671 -0.88652603744040392453;-0.62272946026425690658 -0.16751883048854554481 0.48845573857247559513 -0.44701997676558596906 -0.51377874335219075874 0.99482982884896042908 0.72630389257187577545 0.054912738220245366216 -0.63548240234036668106 0.8272063495381570819;-0.62907378302776506551 -1.13550635628397667 0.83165976381858353061 0.1288214715385601894 -1.0421706721930030781 0.44460474899530888493 -0.44171852912141656988 0.34772615719202842888 0.65325369751490824921 0.38194197944786723031;-0.30705354470264978328 -0.36705232195132708739 0.97314910098612361633 -1.0584638925664842102 0.017470468434640003957 -0.1338128234645175052 -1.0397216654701875171 0.19566007002556265459 -0.38113170685414304861 -0.017073029137616449469;1.0748644077069950953 -0.18941954004460392902 -0.76067990891317860402 0.51932618733638924446 -0.062660991349845415743 0.99079945011179415548 -0.62031895622634114495 0.63454169175931507407 0.84429455859309099353 -0.05498796064585272092;0.66527901132349998026 -0.20652003560862172704 -0.14854919987144593607 -0.97434506001602905201 0.16811408558675272618 0.038989988517275586677 0.81253092873510479599 -0.94121888219311511392 -0.59754543771350776549 0.53728727826938460499;-0.50128733713613504719 -0.22516654077391723421 -0.35356844057062747355 -0.34344984266283562491 -0.7520958801429121765 -0.41041681644310940014 -0.67893046552974301022 0.63856899032088487722 0.75308120243359144563 -0.36530023064648453612;0.25798733678280511006 -0.26868694860469322094 -1.0900736373757904385 0.19307578459105212421 0.08437872090756012855 0.34814294864798411844 1.1189396189862597097 0.22775955523939939162 -0.98545074531147380803 0.11455335274696762382;-0.71380412009366611681 0.57901552263166677914 -0.21336787467412482444 -0.74209008187544733826 0.71271984294742740662 0.56790770490810982274 -0.21346583170400312834 -0.63060749846054331424 -0.42134030804187566632 0.4703517527341874449];

% Layer 4
b4 = -0.56659332279175944613;
LW4_3 = [-0.27003653813701827824 0.53419649638902899635 0.36839642858984233964 -0.20790253085028981284 0.1005629118885154466 0.41101897801445785863 0.72828787310201581473 -0.17116770912979492603 -0.46809403039924357692 -0.30227232561670158706 0.58206994568319470051 0.44438851775487103746 -0.40363819373879966657 1.0958500769909855777 0.066130100355392074096 -0.35999163137277451208 0.069958885589396502258 0.46039665390829476177 0.57276112494114617135 -0.11173378252144486322];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
