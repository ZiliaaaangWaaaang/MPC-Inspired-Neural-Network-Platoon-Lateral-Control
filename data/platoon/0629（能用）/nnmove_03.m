function [Y,Xf,Af] = nnmove_03(X,~,~)
%NNMOVE_03 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:23.
% 
% [Y] = nnmove_03(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.2432837396787;-1.77671183213846;-0.522218457189092;-1.87191152625995];
x1_step1.gain = [2.00451934292179;0.784249478632966;2.12176577495543;0.53194555728415];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9602295202836219623;-2.3546313484817140704;-2.4607094072667807794;-2.0493058051724375446;1.9108095855657121209;1.5860100217925239274;-0.97984378865666499347;0.67140934523775730458;0.55748771555179732484;-0.0098693328809317387718;0.25196666996691940987;0.23943496971936495399;-0.52589014598721728344;-1.490298287012752132;1.4859629185252944961;1.6845473299833551017;-1.8464171528857977744;-2.2944698582232816442;-2.6779469962848785336;3.0531367248997414166];
IW1_1 = [-1.5028337577803507763 0.72409158861250388917 -1.7769724031222504657 1.7020408544661072003;1.1805643293688401485 -2.4691118943226015858 -1.5564627561593686877 0.85042364395301672797;1.5941991013909875274 0.19010737837189026211 -1.8304633479830059173 -1.5422541465334453914;2.1479317938879534111 1.4771852569246675113 -0.21295423620754833083 -1.4421880840383587419;-1.176611887669786638 -1.7491057801067484423 -1.5477667610991381331 0.90160478354875051021;-1.0230164523230695917 -1.251279371535906737 1.9602181239546783154 1.4066332327370603128;0.010620163948262175552 1.7717103962254121541 -0.45769048396646022647 -1.9482523892120231501;-0.46947875088573892688 -1.8961097599224043808 2.3119480890512473792 -0.16473681728492137188;-0.074210960578662416021 2.0564759726344501445 1.2137578260639680927 -1.5224144407608430907;1.8611460428330068861 1.7979057038951316017 0.43972985606699277472 1.1988358264340981396;0.74740463715259419786 -2.6898634241698444747 0.097208302192018689047 -1.0548624143042542034;2.3000761080341725062 -0.79398573631720836818 0.6839101425114219035 1.2064700883402050824;-0.19134287175102371314 -1.5562025416673623823 -2.1897024204368080724 -1.3742250062914920239;-0.16612686888909641847 0.25702957265322556868 1.7449892148063557151 2.4200165326730624926;0.92616933029209580486 -1.4593371870571019144 1.7865257141269887953 -1.4639525537228748053;0.89441825994671053657 -1.7969326719002494119 -1.6961869242576248507 1.1520390970911151829;-0.12721896113938846451 1.798171757745893995 1.2127732026972692925 -1.9032415703372953519;-1.7261479892533715397 1.9700760954186846696 1.3113230798525012943 0.79081589672067320596;-1.7819801174769103191 -0.62754829233229458829 2.2461773152220905203 0.25547945761426310574;1.9398832072990341846 1.1286188211923151581 -1.6814122833626663489 -0.83365151613862220614];

% Layer 2
b2 = [1.5067243271542685168;-1.2467784355531734697;0.82063714326064263194;0.43791447430893765125;0.029403648749070303292;-0.16947905311397540307;-0.57976683619993996111;0.85781173097720497811;-1.3574147886433201027;1.5611062603877707833];
LW2_1 = [-0.50137520921349076897 0.01599372881552537512 -0.046496353417189502377 0.18721354451765007121 -0.35186113585972944584 -0.20664549645013968737 0.078004361274645245272 -0.33032444947127947987 -0.27442383333909675658 0.23265600034256705975 -0.7639866237204117061 -0.29209529378990622961 0.48981816676525613552 -0.18501764788164495878 0.29012819237490461433 0.023206156835939437816 0.49014885278477438035 0.53086738711045988737 0.016668479925268535335 0.061750426428185435646;0.3009037339766745256 -0.33922178181644929706 -0.47548171665734678681 -0.15968607288261157939 -0.38000173159355271624 0.55483051374615910412 -0.40437121266447217938 -0.017629127895309636836 -0.078741393809740073406 0.047308607049845186054 -0.26296021753325748982 -0.18580747111365683577 0.41826431576624573117 0.016980886627922200938 -0.12112418250231023198 0.093186002427411332438 -0.53092616292816174894 -0.25497509645211191565 0.47739320175840332938 -0.52250137487466197239;-0.51901740591617506748 0.071861622995637239319 -0.22275243817782219846 0.077750608145086802514 -0.072838199319421356726 0.58498487305850055407 0.14640276486495798491 0.57887113832238146216 -0.47705461101443602523 -0.1667662624405759908 -0.01870306372511778073 0.40132096466887384745 -0.62399953788753848016 -0.49050667867693847901 -0.31030027304221147189 -0.13023094293703321722 -0.43284241908885751071 -0.44534065158102786874 0.1885184163767147647 0.046214552152083997194;-0.071391406331322668222 0.55839016277452269144 0.13818862106055118666 0.25695865582539517691 0.15440113030086796697 0.063649100817128309582 -0.44785100687519491247 -0.41300456364833820766 -0.30353119937443717724 -0.20477841378500311054 -0.51900349560302683205 0.47258623185255810295 -0.0086243721531569714212 0.47517318759083765345 -0.38585507297838528284 -0.45084800413160175392 0.31036355375469076856 0.67066536448880165189 -0.18800485303713623808 -0.75769335253459613178;-0.7215823773016544207 -0.49794932189382473675 0.26856271233394785058 0.55894150663967012704 -0.27314229210716456375 -0.35709367029145083761 -0.32265390184392422901 0.50804474084196160621 -0.41374258220656295881 0.13080127001911695528 -0.30303131617805151299 -0.24065866871368640778 -0.396691575159063059 0.078519046514431284356 0.46346442793613717992 0.13547000794048763561 -0.23904680931909003117 -0.10879925491112765745 -0.15002984602379587642 -0.26396352547825036039;-0.34797092007912394651 0.23686692186817870365 0.48435847675339638307 -0.58708193208442260858 -0.29429247071907460587 0.016637446460354820416 -0.076607266774873228332 -0.081934034978530079218 0.35617687406152243046 0.21521748407513457968 -0.53258337007501277416 -0.1747934640959572794 -0.44303534920949200204 0.38058120698010727834 -0.029520810470995657165 0.24210258479033586188 0.31634926257006168449 0.27613924913946985562 -0.1035223551677082604 -0.1079579476489160722;0.008353095738005486201 0.21147606022448123264 0.54156568113078729088 0.32259010231632745391 -0.22346444559150649423 -0.12552352080866110984 0.47876697807707235821 -0.43435610301171900804 0.34460192765933250758 0.002805237720438882084 0.012416351903349248653 -0.20595541369133782417 0.44425876308914619139 0.21562462620444911021 0.40859711628531880656 0.10226588412666107186 -0.38651253821003483946 0.34720374202008835729 0.52064515554406520792 -0.60739113381825493576;0.40982391149854607848 0.15548119345110880674 -0.4277569692947087443 0.14358860757807490049 -0.23182227075722894316 0.37160590402628163043 0.59906231801100318091 0.0056306184258826299377 0.31973220311678657302 0.43025482941984349861 0.20859683836492276532 0.2296249639444883639 -0.59623523374810005748 -0.39154091147667546835 -0.37399342347080766213 -0.24430168510366181978 -0.2591122281481770262 -0.077389605051413970505 0.44289613534626953717 -0.59958491290672943919;-0.47787434844823839519 -0.1338730060313553516 0.34618630636538566536 0.57727689002398463458 0.39918248047027066194 -0.42186355405920517025 -0.33071921523858216485 0.39150031329779994005 0.51387145548573898157 -0.086157412004534819627 -0.19883526830103426253 0.25719135859241848419 0.38643532703370930825 -0.16300848093928432814 -0.36223692204427482277 -0.11063903974723607315 0.18749544504447127058 -0.48445274353104061937 0.14228187024306995778 0.40308053102421076419;0.36888427930142470013 0.11331766203720575192 0.1597258352989498198 -0.63801612274085384158 0.012057844351164855728 0.33192007384906369039 -0.14514538999223164373 0.18991894025022817982 0.40018575428819247453 0.50633257238677187306 -0.10599877135672021444 0.25523494284679143496 -0.70912400657180485464 -0.24635117221612085059 0.41555977841343266777 0.31107174510714846738 -0.18869479963747373685 -0.54868841525896194788 0.21250916574912759316 0.044853447946230987076];

% Layer 3
b3 = [2.0766389997676415469;1.6056745365872713283;1.4561224248749553567;1.3166231439814932713;1.3242678844425335161;0.85004226935550364352;-0.83541351690654552797;0.40149431983313871308;0.46371003115082665147;0.094744757948206748122;0.12726234611322148615;0.31276785341001522855;0.49898513812391509514;0.70611410941136709685;1.008010768937828594;0.93548415727241218676;-1.34106422244702439;1.5009331170222592888;1.8128961309106232935;-1.9128088064750243813];
LW3_2 = [-0.26134742546474687419 0.74768709637522867695 -0.76959347833751556855 0.46834122623630136673 -0.30839031252161108743 0.44010735467859735115 0.16031811521229055728 0.15934141931362486022 -1.1959434315979573515 0.2999140741594349957;-0.10663192398349209677 -0.72651166224271968019 -0.56210608345956147858 0.93332269296806436021 0.58933461037938239535 0.70576585061122698583 0.83874393285791648545 0.50078772921958358832 -0.26658232640467660612 -0.68336773847689169514;-0.66423980749286959391 -0.69591529083973879821 0.53610942232124569884 0.87311315820664281429 -0.073608045532597990435 0.62176800024447498316 -0.015567520445425137368 -0.54845359362739876108 -0.8285721855089188681 0.29021095603108143512;-0.64456718232558640747 -0.93612969472743201571 -0.15020495281135637367 0.89132635497355827692 -0.41109051350228703603 0.28398930540885919394 -0.068177167961673362795 0.56226131880062624191 0.18705983250594213074 -0.82903567455244975282;-0.29738161918283784191 -0.7233958514144789298 0.14391021856474178753 -0.77669203023962152255 -0.91067246651979705252 0.16526175877229107303 0.55219076112236464837 -0.27187358400237476852 -0.14397835801729644278 -0.74345908856327025394;-0.37791374438473523956 0.13111571356079460005 0.8490310586312711516 0.931450703561944926 -0.46414379194146454521 0.41920834073505425232 -0.76695405918037751203 0.82178759803055401179 -0.30360574014057561953 -0.45339831708663669296;0.51956195480721600877 0.1269890261285825106 0.83720946155367792496 0.13243623422174657933 -0.62813555497028605856 -0.16143552661238877444 0.8050535708579472649 -0.37496511342935434641 0.46468571241701212005 -1.0169224424599301315;-0.13608574009346105504 -0.23812348911191216771 0.37321602105439172226 -0.84668483409765671333 -0.77358674628141221863 0.15776521501596726949 -0.76454181033104473553 -0.8044596914477599725 0.64002233393074048351 0.59546983975894973717;0.068399547675554797643 -0.52933149696729664413 0.38180630820554772864 -0.46518864397134684907 0.60100649760885294093 0.7489916600727108964 -0.11176083347117764244 -0.55302030874155483353 -0.69415562778222850149 1.0775770733432834536;-0.52889650894083395372 -0.57239872835877614321 0.56796425508390391279 0.67612817352728438181 -0.75826332774170768225 -0.86316699423328924201 0.32795830325328501065 -0.75794978968626025573 -0.017602696607050816874 -0.17992795547017784163;0.97057338211686805529 0.68583948933221872135 -0.025254925227010147776 0.76234292255985902642 0.16784863336342370488 -0.035996515046367194568 0.11693474274066220642 1.0308485533578291005 -0.15275343692381898597 -0.72396465312002344916;0.10681400141641188284 0.44347266379822125604 -0.71400519347933233405 -1.0664286989930971128 -0.31327364535617824304 -0.31601500275034261067 -0.02915758507253257692 -1.1428512641305579312 -0.39486450596655015 -0.14711309545586126468;0.88284444204730483374 -0.091854482018140962141 -0.44635131543355521799 0.5052674871408845414 -0.41297625631032641724 0.65489650194461523913 -0.26875865704983592508 -0.97469324036192761529 0.87910235981350370871 -0.19418665888291841704;0.31094057686838322274 -0.54153922459087411312 -0.42624181015813589202 0.56579827082110389913 0.35437092591152663523 0.37778421016332419669 0.19912456822795429612 -1.0150921403212618266 1.0562262746449386785 0.49456797400842550383;1.0043959002902469457 0.62591374456729464981 0.17224168997088945554 -0.54470326036429361771 -0.28849289310679926412 0.89204880672345121528 0.76536436226184634268 -0.46871913534303305537 0.19515481148312391335 -0.074210158872708389954;0.57426186774906562427 0.57537798183691402087 -0.88964785587037487069 -0.6377806594549021435 -0.62547578257536295965 0.66493021704601418254 0.37891795829585056543 -0.6044062080274864579 -0.4016096977762114717 0.55544419985694948316;-0.42409174273070721073 0.70548699787403890138 -0.86711373031382044108 -0.42065368136634218033 0.25806207627217059297 0.59536806332408387377 0.85539231380604896504 0.20097137719734015082 -0.61694107891218630257 0.70163521858947242027;0.27523403626740544636 -0.073598537725409848842 -0.70820158383000997304 -0.85593587663773618157 -0.71496517000688641907 -0.078455980835890240521 -0.86744096929611436142 0.03687416454342502814 0.17478281975776477353 0.98123014737562941345;0.43295861755518039171 0.93695422725298349587 1.0967298862968919426 -0.08926963959457542841 0.70611172624461759906 0.17903354446104766118 -0.1080934363734771253 -0.43552310358655421663 -0.45156277062471594785 -0.21483211826087109109;0.015322019245186247263 0.74226053415320181195 0.68946491276032706441 -0.1904511884350345019 0.37198577681054734168 -0.72040679394803219804 -0.86330144106018225081 -0.6997271284905886013 -0.50252479902178248672 -0.49907775354552214031];

% Layer 4
b4 = 0.43267592648393554677;
LW4_3 = [0.60654266509221665959 -0.83441661294031732599 -0.57324525007618609695 0.041693692275897517585 0.2471547123210892094 -0.57187034775867162661 -0.45782142622190497017 -0.74770135521069625018 0.7183403306138452793 0.55146513413391839986 0.30477716234854679289 0.45221130215635746419 0.34233701451255682535 -0.12392625406834639756 0.17731164084931769209 -0.48415898307089716424 0.69145083203394597238 0.579033303223293494 -0.34582514970731165205 0.062560329826525484798];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000001;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
