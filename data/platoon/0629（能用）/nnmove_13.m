function [Y,Xf,Af] = nnmove_13(X,~,~)
%NNMOVE_13 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:34.
% 
% [Y] = nnmove_13(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.581224840168548;-2.08798180279202;-0.533403245818273;-1.89546903030855];
x1_step1.gain = [1.49735732495204;0.473316379586819;2.00103198696217;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.7756002481633377243;2.840602976495389953;2.354986441444443912;-2.1047285428801121299;-2.1250661635196794741;-1.3896268334849148918;0.99797651885226668078;-1.1926412374021804208;-0.053686504590483186128;-0.67641831184300860169;-0.16991141713405708003;-0.70423188393087599035;0.62110861232134917387;1.451119145669556687;-2.2985278146269401134;-2.2335297326636358584;2.1343060962719655471;2.3371225272822755414;2.8712052655395696732;-2.9479030717692600305];
IW1_1 = [-0.28977182736156886778 -2.2917377670900789255 1.6596171565596724573 1.0770810163500401657;-2.1295209674748050155 -1.5509011299186479249 -1.0919341757089888745 0.43494155750474455813;-0.41947018923681783642 1.2867172647606832658 -2.1265780000721372645 -1.4087244987428435561;1.9195151253318891715 1.8215862708045911234 1.1990952699600916365 0.84899968990351304399;1.9749137178013851379 0.41498699929394206043 -1.7766895439651484434 -0.49391014334348715131;1.8458569939925590919 -0.81792784502320581286 0.40090403069376995271 -1.6618862933681799454;-2.3195481124073862311 1.082980263616175387 1.2374754299557300108 1.1199878651805919016;0.7283331205460518154 -1.7426477666824395918 -1.2401800971071876845 1.6607818903984836734;0.93608318252953548466 2.4315942219109296651 -0.95245010927324957883 0.89286832057014131614;1.3673639620921844706 -1.4279335604711094199 1.3224782484124562032 -1.6045992541320517333;-0.80501013887459704765 2.1976086100698792869 0.69770898962736394022 0.96359185686031723073;-1.3142486020860735252 -0.68594534526702133359 -1.7672590282840265896 0.76109417045431859705;0.47950664445565405192 -2.3791421714263898401 1.5338611477106596226 -0.027334933359220690147;2.4239422652417763615 -0.98629417173233580041 0.51831548352065792695 -0.56052173795009485602;-0.35996449576968664319 2.5180124237510201901 -1.6044546459960773443 -1.6179625497954153168;0.14065934837746901787 1.4349095922510946011 1.0300069270773573038 2.301656979043543938;2.1098178383356591681 -1.3324636627273254152 -1.0815620430882866287 -1.0825793879493366134;1.562873985261876264 -2.0033242902848722444 0.83367763853505760796 -1.2250753839853982807;2.0214668251714784653 1.6870029156746488841 -0.86895748493470470475 0.41535224900438755258;-2.0719076153548638963 1.8798696248079962423 -0.055231292925281165462 1.0061110971074678222];

% Layer 2
b2 = [1.7535876174499758218;-1.2170045248100276325;-0.94278311123234626034;-0.46649177102046590626;-0.22273551271516567329;-0.37562365862221230861;-0.46260031955694475014;0.7940661831676056881;-1.2562468655212537527;1.297721530076228813];
LW2_1 = [-0.30265698597871704134 0.25070366167729002393 -0.56531027215678242293 -0.2172093425545267853 0.48212924202456131084 -0.077891287515408969 0.44771122527036977257 -0.53249032478705482507 0.14468887347323070025 0.25970976028504816346 -0.3580236457740358369 -0.28401748186992037404 0.54087933316628700187 0.41387919018145746808 -0.044322618493996220057 0.015620068215934708455 0.40046941150847770174 -0.31676449841251674844 0.498692017113852748 -0.18990506629688561069;0.66622344601639360562 -0.46626805051622843834 -0.46820456768803020431 -0.35945881163789378254 -0.59495846754491577002 0.33515573139169352324 -0.15797811106159881378 0.33434050457363229114 -0.40560449406578424902 0.29058692651160528131 0.25135997612338961682 -0.6354070202567942971 0.14595689050585800017 0.54497071859059942334 0.45642552157361904186 0.12632211900622219991 0.41435449878860419748 -0.098332112511999622551 0.085346119057437441757 -0.28372626790212607251;0.57542453589453435026 -0.52712591527736274433 0.056426499239561618559 0.20018291204984300924 0.018724760171416422738 -0.38249936030232917217 -0.5896055330863405608 -0.31201305591859845867 0.46040423768014887562 0.67593557067347354028 0.25444554219973808395 -0.1185771733512414744 0.25702790969055872017 -0.12189562862825126244 0.6639151896181916257 0.058496955984829443476 -0.39009873474355427625 -0.29357489695041982802 0.039228998173032325614 -0.11078512967190656813;0.33748217294684201839 -0.41826743491652162987 0.44513335001174236805 -0.41387729979852183604 0.47886670700542521839 -0.37769476431722548426 -0.49400509905349937467 0.065681897181026988042 0.043839043497045475373 0.35522979441796481703 -0.69139523588314943936 0.1445250783742075551 -0.41396666256112074622 -0.081929737038799035909 0.17303747653305850962 -0.40447879440869372036 -0.26344623285682661207 -0.14525771382956545463 -0.18458611132561825174 0.46361183795866800494;0.33756773402074730095 -0.42507270076153569338 0.09772876871660478304 -0.28246149660854619201 -0.23545799967983271905 -0.40176932509474688748 -0.84732576263129044669 -0.030602260056896323642 -0.87809657928816653438 -0.46390350027832327751 -0.12754583209688188927 0.26605995708447388592 0.47789197536920180465 -0.25865989408915868175 -0.28377060262471448526 -0.34717475328586694383 0.4208004293631399384 -0.42714797776415353026 -0.1522386468343764343 0.58621997321414387461;-0.44114783426275477884 0.63443743296451449165 -0.24459942792873662354 0.078087549604016703864 0.25734080586880253572 0.087628238458194854243 -0.096259244471562269152 -0.0029542486735375864115 -0.53092927363691444498 -0.031395381871933143725 -0.70694615835340479659 0.47434324681349104846 0.20130521819562890995 -0.055853401758831786039 0.9004067288374152378 -0.22570812644789089996 0.30416844958004585209 -0.72670265926186228267 -0.025734423393943144792 -0.42122969953621958172;-0.59746531329891172657 -0.5853523386062593481 0.44729605792003473974 0.36389539448403346311 -0.54849165157783452695 0.18828481319600587351 -0.063721065945418514653 0.29204680056315523995 0.29661173459905870731 -0.44840819116547125933 -0.53187370938377775964 -0.028938249164214564779 0.23606760696991757609 -0.51958810041460656848 0.63289104488272862614 -0.46120445162101575409 0.35048749842754062245 -0.097987965900909024253 0.30275874286826265358 0.12957428658870184801;0.46432900188462594704 0.45523207375541846487 0.27737928227506031265 -0.33852405685683911729 -0.57729934313755459918 0.054516776481253061137 0.008052869810182144289 -0.65762045502519517193 0.10646398113746191605 0.42684542633338401485 -0.15075710239183118255 0.15250048643198413356 0.75454154653802163466 -0.14447202908614709127 -0.32552074027544397605 -0.22484391494918196108 0.45103468615880426551 -0.30737163003977657771 0.40699941932867617078 0.38300244516025011565;-0.17519287119667623087 0.57606987294872502581 -0.16377344678769709119 0.5715101586801901723 0.27261163189499421078 0.11647161176267117888 0.60792789148199566363 -0.27443332338850850993 0.36510344877330014324 -0.35203515538420254716 -0.13389947605246652063 0.21098907930036425729 -0.010170972122055544837 0.52620204650417479186 -0.28851719397877578777 -0.46981007617840037094 -0.47374843862053039878 -0.41084718452208895956 -0.24814856779959701405 0.18527479661725851368;0.73241708724998744184 -0.19657707610222632799 0.43411433938814503186 -0.011264294659026974701 -0.72287226047953734298 -0.44044216213987541497 -0.21293475624665525459 0.84198713643146461116 -0.82093808725402817039 -0.44598417510066351577 -1.1198091362368884916 0.50033506610825573269 -0.063760911948867973753 0.056678969389296660064 0.092944236737343977062 -0.1078821780775252176 0.23680017016726731538 -0.094572329142965455562 -0.2304315919543542257 -0.15419047135362948242];

% Layer 3
b3 = [-1.8968888937726240407;1.6337337648994123551;-1.4397152800564316788;-1.3990331586008133424;1.1011017814570367435;1.0081590408517386859;0.86039869923591338896;-0.4058613085870603765;0.26429360193350304176;0.1671464929756535378;0.045543283811414911333;0.43367168533622207915;-0.51697448556315472867;0.73971089741410811502;0.83770812388425053285;-1.1017444730847467671;1.4760483946051605741;1.5237319709699630454;1.7215919191795285847;1.8887652109496706476];
LW3_2 = [0.46098476889066497542 -0.46932547137896196698 0.5242317486976493246 0.75430471566309442721 -0.10904114705359622961 -0.49130125542221880774 0.043499928007853030931 0.74807209353493897552 0.67894952926735097076 1.005552764499837437;-0.87273487703834640161 0.18675850959476936186 0.51706688226586672297 0.25748629952863855141 0.28966303200327891965 -0.096611836123094832485 0.72745296696259120761 0.86716591398233811017 -0.022846522341174776982 -0.98092412001146411793;0.20830969784058472882 0.0077703655480783201392 -0.60797614728049020894 0.66730744339373460061 0.94281587268829036841 0.56353666086132847557 0.34616942326245342398 0.28739634315914386331 -0.86031678664279920277 0.88347110728708166949;0.7210514648762679224 -0.95094853797978240451 0.0155197886593223984 0.23481293719641485596 0.30178726460988125613 -0.064559991243345549172 -0.51797315329237780812 0.12380345623824687284 1.2781030425724144717 -0.44980766603038385698;-0.69254390361958340083 -0.0098393749827528007024 0.060482739683232034089 0.89282727320858579212 0.28998149674044837454 -0.45611224044072717909 -0.10024737353034883502 0.71956991430715078195 0.64840863171170215473 0.98722199431027035654;-0.7863938376001429198 -0.57599320825177990901 -1.1562626664029427292 -0.23997520657016080392 0.48099530160740594509 0.40817584193066708265 -0.48261752060755463978 -0.55114268685058420694 0.10412198552941745455 -0.5736388329173754963;-0.68153328524305045732 -0.049965761062965526051 0.31964575664180588932 -0.94773440987725998674 -0.90568820229230473373 -0.12577887233291829006 -0.78524601112735414876 -0.71614287517109032066 -0.44176773772368099769 0.74406825481912208797;0.60471004957437590743 1.0835757036644453333 -0.64666238699318845384 -0.62896405755234641166 -0.42672730546064435719 -0.9302059055672072807 0.94244282604240270373 -0.32737451446735210681 0.088065271874330122714 -0.83264137293585971378;-1.184908419003153579 -0.30437261770479412393 0.025894938595500020112 0.27963055303864153833 0.12861726095841902184 -0.31763208925674568661 0.24583933911608557565 0.037309132444083126234 1.019530321018271124 -0.92169922896124445444;-0.1565690851994774313 -0.97499611983022838047 -0.46791215040565098393 -0.23790571153944384264 -0.18825620133518619626 1.094671207320393469 -0.20353044609767712014 -0.54866194003084078901 0.61708714775832418376 0.89525085459606423832;-0.4970306128125712708 0.56351153489275929154 0.11550853207555497604 0.1242826058878093165 -0.042458703368793995758 1.1331146113576480161 1.0356940559059735207 0.98695602711349672553 0.57292531328019213888 0.017400875529458299795;0.14648606336377159587 -0.50724308687916841443 -0.20497164350944646616 -0.85613528488449597287 0.62417743228623379093 -0.53114068042626816357 0.44430728037867472935 -0.80582678269309326868 -1.0938039262809085006 0.18493462726496648352;-0.028187303362057807704 0.43356971625806695059 -0.60395674579358227252 1.0991884763938444269 0.43040164207153019937 -0.5915829587830947478 -0.0075250052459537447591 -0.60566754378471021614 0.74936118893015812858 0.5800101726215610709;0.85338585103340758309 0.059825726954061408946 0.074393722466322989573 0.41853696708202087207 -1.0902374037398523399 0.57306434660457206132 -0.28348724711041028979 0.0044348469366361220612 -0.2519469570401527414 0.96443690371389834137;0.088205268427747618443 0.92726174914667591764 -0.81199699029235128389 0.56237397375703157554 -0.40949956060710024364 -0.29216164590099319431 -0.36181897196150553109 0.24120003113248097981 -0.44945708733141931379 -1.0869195787165202294;-0.6488576614693356559 0.2859491357366261699 0.13614157656386277617 -0.12012952115507678774 -0.48755593224027010679 0.87199274249292768602 -0.70628462795429447496 0.6178460852106680834 -0.91351484427779727771 -0.78712158354088379575;1.1016866964159506281 -0.34341207909409177113 0.70977097314083337221 0.064146011664347579728 0.67815104180344998319 -0.18333161003292561264 0.25567818073591314088 0.51104680457534523708 0.33275504915990611332 -0.78219291283069447562;0.42381066175406523211 0.0080908819157965161661 0.51207039473372761851 -0.14518393629148912405 0.46978125925422320464 -0.030011766299127471541 0.96494713006351806595 0.7905585373958518014 0.81213143847834801115 0.77345858762749919446;0.038464286553058370244 0.19365616804308347088 0.038099876154144902973 0.94772840054964901935 -0.64148418484194080769 -0.52540143969936936585 -0.70602557023119349999 0.19292491931991612164 -0.97587380053202255059 -0.69503958598768611488;0.88367750948803724942 0.023251645935522976399 0.47145278920101674203 -1.1153262646474064734 -0.41543344518170743918 -0.32563127729592655779 0.74100901027746213234 -0.02306125130002500967 -0.69805340358280121293 0.069782669689829684989];

% Layer 4
b4 = -0.25222831164864689679;
LW4_3 = [0.19147479656351076849 1.0647027610136490239 -0.30836685473810149238 -0.62266697492464706531 -0.085195569258328704421 -0.3415877613393613621 0.9363669611604291676 -0.86394597508537152031 0.67294219421646883639 1.065735128020571798 0.68945817368231399058 0.47439747978191870725 0.084534798221140905472 -0.48376384210266520913 -0.56588983768076273062 0.58383238792324676503 0.67644449588990562816 -0.41940758344557937942 0.67551648942666597808 -0.0871566609306837492];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000001;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
