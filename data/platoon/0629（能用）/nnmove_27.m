function [Y,Xf,Af] = nnmove_27(X,~,~)
%NNMOVE_27 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:48.
% 
% [Y] = nnmove_27(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.644786415382709;-2.24855099234896;-0.581789816284725;-1.89546903030855];
x1_step1.gain = [1.42933908693485;0.45598879896227;1.88894161457496;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9032411710135614946;-2.7171176581764493463;2.4114610878269888694;1.720762318495702381;-1.6514581164902795152;-2.1047148556105379491;-0.025245679895888051281;1.1053853674887461622;-0.23146979906011336259;-0.70239927904417287507;-0.47768482388413280315;0.26132474104527786407;1.866878603839420947;-2.0208272688071908796;-1.3123344634643394624;1.4671826701426813333;-2.477285147510309482;-2.3482304327612624206;2.8780595898732257432;3.4685973768371316517];
IW1_1 = [-2.6150027682711733945 0.31154870080273011634 0.10960914928342688213 -1.4605170193733536532;1.7434235970756746248 1.2716296280548153863 1.4835412480534795332 -1.5544585075903250004;-2.1102497999865681422 -1.8725574818680867928 0.36611131404083713248 -0.31479429905696698633;-1.5411225921306983544 -1.3947271044922180394 -1.6139877865194871553 1.995218467700552667;1.5659887728998949097 -2.8388261108138217459 -0.42040927374226183533 -0.15805038213646055434;1.6363022087703666951 1.4780060942348718367 -1.7101767580006526082 -1.0531426766642437709;0.97908132144205473057 2.8938743427757835924 0.93696669239800256523 1.010485673802952622;-2.8203807946997416778 -0.16379164111728508613 0.11064682853057022927 0.089721684117056305086;0.81902019033455741859 1.3658342640208953611 1.3193010929585224922 -1.6390733188324349001;0.21001499663482800506 -1.4521834103882604872 -2.0589281525441691656 1.3600347071899192564;-1.8207774722424288072 -1.3377392125188072303 1.2615512923746268203 -1.2003691821522297634;1.5015752584652692914 -1.5385089279990249445 -1.4137155469230799909 1.1161107193666881532;0.73635752155972855615 2.3984483488666659134 -1.0904661826600456909 -1.0871022660274480831;-1.2134216166368663181 0.85358881425839272516 -2.7030003280147938405 0.84342170129521176758;-0.61239224166768557733 -1.0339864857562464096 1.2652685242298284951 -2.3320439464041831101;0.62047003784654852776 2.4922906937642794745 -0.24455113276033030312 1.4481814043582617035;-0.47525506504239367622 1.231516409058914796 -0.86089122101844706147 -2.3537605756492649967;-1.3619817902603286175 1.9123806653405324152 1.4312735570608021707 -0.9594844965569303552;0.30303760251354533439 -2.2646906227460239514 -2.1581913665225282983 0.28261943930914490419;1.8980242035496850406 -0.85058696349662843428 1.0039501604424907466 1.2945503222077767713];

% Layer 2
b2 = [-1.8022083594360884806;-1.1416624892794267065;-0.80788684030524637869;0.38561816916706542768;0.24409257082739174716;0.23526131914107697995;-0.67576122356119872059;-1.0820526962650245384;1.2400052189787396095;-1.3897801595633325622];
LW2_1 = [0.28032811849865080234 0.65303153401331137662 -0.35128251354369782744 0.28667022381756973592 -0.66008373163889488833 0.36953704054789188183 -0.52273946508126145627 -0.19103762726633935487 0.73914212251984112712 0.049918969788084882611 0.25916734315576145375 0.6739383023042362364 0.091087315192299372901 -0.425352264071893027 0.42861231489188716948 0.18648164135848160905 -0.41072389883052068393 -0.16558720224777911945 -0.31767130531712717278 -0.49069334549678988999;0.39895048489024398375 -0.29892728721319195007 -0.61313796073025539357 -0.5988668532828880231 -0.15831567106653721133 0.064229570805512364862 0.53270201713510612063 -0.069019723504712998663 0.37144657676488462839 -0.43076770942158437716 0.1560648718339054386 0.4384834808258722405 0.50869821400189330074 -0.26613264951950887927 0.34343296082034296957 0.033856959676454273511 0.22406835427891155788 0.34790496157385408793 0.030677438967276374898 -0.31721046659207974283;0.39557550169449695598 0.71333938387469830733 -0.26477371618867467928 0.071022901950481484579 -0.40032011440422149429 -0.83888074054983496897 0.88496011044028100034 -0.28793996215759465329 -0.28125050791002470518 -0.31522587306915045291 -0.13294043001848487862 -0.50298043583733165196 -0.7491065368907663391 0.45497282002076955276 0.29957561403093896368 1.0047133386221034357 -0.29054673040120210237 0.094665491822726766102 -0.2936429436832618256 0.36299979793019032659;-0.040598545282558989866 -0.32112821995367857308 -0.39512716291157529147 -0.12630435225291691825 -0.12024777282872155248 -0.33314825086510219121 1.676263157337440024 0.21516633289172418242 0.28450354611020156614 -0.37802146585033452597 0.22795691873837239938 0.077658073882933470466 0.38937522458283563287 0.28264041708370946093 -0.63726025559693988409 -0.4840411718665703078 0.13065318227745650881 -0.28019588508756099188 0.41273682990845328433 -0.0095569063462607392601;-0.083638110223529293918 0.37659896421425831381 0.078591406406343336521 -0.065715535478860942487 -0.084962845550924093185 -0.18625982660644943567 0.028133161878893600538 -0.29805436251162020778 0.33768342507616416759 1.0453918451798303035 0.62115779061896259083 -0.19283277872592727298 0.22167952709145072321 0.37377734227833142588 -0.57922393940071814633 0.57095002597540578382 -0.33857002064569458044 0.17495051399619873655 0.47776283338320385541 0.63965552736689612612;0.67351632929678750816 0.75103862013685906973 -0.61523800113141979828 0.50550457848642516012 0.58555680655245301303 -0.10935352478584647873 1.2832776359133493127 0.33585210627630757152 -0.043756722119935517745 -0.031099454002607763298 0.062957449104135962403 0.069244233577602426477 -0.047160374157530507433 -0.39102999173184421755 -0.010292196844454776922 -0.14222021685070226904 -0.65357410478112765162 -0.25299847189903784672 -0.069032812690850903214 -0.17566858087300424307;-0.63631989489843354679 0.44409867994438834149 -0.4798532522323301075 -0.30767459997682899964 -0.78982075096229409361 -0.66668906069529076941 0.42517501943004992748 -0.056641977249731412236 -0.074303079604314620221 1.1789768099329924755 0.8279444265150891491 -0.16792645200301917208 -0.23207324471927889831 -0.32660296507699831947 0.25132036406292090902 0.4891652740897694529 0.31176024411758490595 -0.44673544313535451522 0.071671637405028715273 0.091564403302932306783;-0.36216296648734952468 0.28249065946807772054 0.3845421318419507406 0.65324631380897280053 -0.094158004132674569253 -0.66502677226813045053 -0.72436118919121417203 -0.15417384454624127876 -0.2299097944067086674 -0.47977661326990117541 0.38316555598628337931 -0.62622512653321227294 0.12970124560797502422 0.064276484340732589762 -0.42915590753628035658 0.026740535169152781364 -0.25781456886431847186 -1.0897201206327529199 -0.73561112794296990014 -0.60461376102895458828;0.77819284158028656506 0.29372758472381171879 -0.035977310452180659428 -0.2883763067348333875 -0.035360463548576692716 0.049712534311425790601 -0.086551367482929547625 -0.27170461954834812524 -0.41760653660021784805 -0.14618941205133734185 -0.36272976127500305976 0.14982499873990309802 0.24288558187743899963 0.19073238714718673825 0.27008139731280106366 0.23838837286003700111 -0.30412950846700764762 -0.064231305552852849261 -1.059428697564459565 -0.38848533902198073564;0.099022645772732689751 -0.16664469583274149622 0.010288541558680976487 0.34963850309193272858 -0.14027081413586484082 -0.7614411968142700271 -0.20011498867587260153 0.21880746674722351131 0.2482724026797102912 0.042650104135822299034 0.30456514792611838471 0.6996758493815318225 0.51337862311729409726 -0.072885337666296470815 0.35795509311589823742 0.035364029129158154607 -0.29869192168695657408 0.51647989021898510487 -0.5125767327148913477 0.7925449496257388482];

% Layer 3
b3 = [2.0680644439223461184;1.6851841761262369435;0.97145072860522252434;1.4604971505250525787;-1.0243286715472179615;1.0080609700323528433;0.77992385102045025391;-0.49720040656672170876;0.42513180362252483979;-0.16913257749833224275;0.10537252029399345188;0.4516220324383653506;0.20168703180674529829;-0.62745464020774621705;1.1002121241969113896;-1.1556134051605053692;1.3307760924449372197;-1.4830579516071114021;1.928772706105658763;2.0801993350439098585];
LW3_2 = [-0.92154479844903780528 0.97369172860799713121 0.8010669526043959765 -0.23835675248701326812 -0.12730465542541033463 -0.068924173645006941991 0.57555992119313315047 -0.75382129163212407974 -0.5121019486540039356 0.33243811805805018045;-0.24276349629882870707 -0.27707826818086528364 -0.19104237100170279318 0.58923157848947149695 1.0732035745649803893 0.92911582487120414342 0.28879970156983247875 -0.97270718319128479656 -0.056667771146484566258 -0.034699258022381218591;0.10209877914162680812 0.74925107208209906773 -0.70166619583351708123 -0.75793996308449218535 0.040801143890662749936 -0.34038171979326747874 0.56656610729369782931 0.68332827766618020604 -1.0020350787074916443 0.23019659304226577912;-0.31615264229216960556 -0.80471829931183347373 -0.76275556136544064856 -0.011876143093221994823 0.85940353432257576838 -0.063266065725901390882 -0.70996039896927798374 0.42868632770434494939 -0.088719768509742835683 0.35591594528307252121;1.0002890315692591905 -0.10478509538770985898 -0.027379467046634190647 -0.35516886680666709397 -0.53359714684707293397 0.45385869923692290229 -1.4198693437344360735 -0.46247455586408170447 0.24742607447366382623 -0.1712633354461796098;-0.078516594257271671298 -0.75356654711529846846 0.27229651304676028012 0.043032274291117791898 -0.33027559959764613007 0.15772448617657142123 -0.30447863356352272701 1.2417269013269076616 0.79882962166143478555 0.61614026808452893036;-0.67767198576238352192 -0.30246501433794026337 0.65382129639715791392 -0.072713275114926756437 0.29500379858837993963 1.010520107797966638 0.22544892873920044374 -0.51330344894279578138 1.0273895763707889817 0.24561191887712330306;0.77947559449659176156 -0.33634119358632996732 -0.63867620297461347167 -0.98382310044944643046 -0.74530948737834723516 0.56811220067718037896 -0.29621741987557614895 -0.044240822868948988245 -1.0308876421783470523 0.30091405719235486682;-1.0071777734809872484 0.031935298657914938658 0.67951349831407825697 -0.29763990261186040742 -0.43175582847610494142 -0.40454837961768053134 0.32188949979536285451 0.44242517151235560835 0.91570715030501659282 -0.59567669491954156058;0.98572444677672432789 0.36677483545425809686 -0.19789752154509743232 0.40258629217168512282 0.46034585794156535066 -1.1704990930602485744 0.22995590438332735861 -0.28428313544672878521 0.33854866787652948545 0.36815656285809217341;0.086357801920410634522 0.43449787724586930171 0.27252403146576709148 -1.2918929432579111527 -0.57917410499470345364 -0.88853735274066847349 0.2729366582202341629 0.38523888100165842863 -0.43893058871926909914 0.054185931199891408661;0.37398367128548359872 -0.87635274188835210474 0.52301264736620511897 0.28278654722433033131 0.87009190255886181831 0.2831407544237826146 -0.25128471745861030717 0.33016715213595321243 0.81610573640294004072 -0.36413131424854344731;0.30447161505470454745 0.44519886677068876146 0.36060481984403913724 0.42650833655308489911 0.87720792694118376875 1.0020523280254649556 -0.73165767729678654607 -0.097033743475273437351 -0.54670356201810954566 0.69884535770979827607;-0.96348397443238509297 -0.86941676378490584387 0.30326498689711461898 -0.34548543199890541233 0.43700311263243052373 0.46928287308124078114 -0.82942955164535836499 0.22580998499726029349 0.89395335596147207369 -0.22497778914047100729;0.53088676210706209346 -1.1352453114620151275 -0.59274563051933659708 -0.025257701507479978636 0.06880181288647449489 -0.44697132760928809381 0.48985825198373544875 -0.7822909982429856468 -0.0072440929000157864431 -0.54932118366795612552;-0.37200771114328551326 -0.4369363328051635853 0.94449122680389219209 -1.3902270426839908879 0.15193567943921945651 -0.74169716903719662415 -0.78409746717785877568 -0.63023737684292857608 -0.62758986342441380746 -0.017286381953213164619;0.59460929981894661278 0.41620975973289725536 -0.30911985269517078256 0.35861285006064269609 0.96272612756342546003 0.8662089365494612947 -1.0273615304754757371 -0.96555931727856203484 0.095028627173044305509 0.97480598030392273667;-0.83034525053571384134 -0.04399929060363683142 -0.55211519791075758246 -0.62116146848837094918 -0.23560562571020748912 -0.57214912934775208342 -0.26376327256287446232 -0.72573629465337829991 0.63878659316989427897 0.40308479774963129616;0.8057819007960616009 0.67494414511648681554 0.4851242694177753112 0.26437597352661734718 0.913892509869034253 0.71359533659717266918 0.50189942272629328723 -0.05004191592698902652 0.44008742777081316655 0.13168204651023401874;0.53126516760367958891 0.7733701349073250908 -0.81319028534565884758 -0.73866621070932969584 0.8534834564748348118 -0.93050499600950564716 -0.68697502625149919897 1.1534370178760655623 1.3552398455266450039 0.69943276330133663521];

% Layer 4
b4 = -0.41875100596767433903;
LW4_3 = [-0.45622172245028436155 0.21170640800581316809 0.083522647370053146321 -0.23124350197517795635 -0.63016959442819597825 -0.42030048931988200911 -0.52242871979421012796 0.73946736192834994217 0.084770572649935704845 -0.62190031114442123616 -1.0334956547333458143 -0.43022184914991534743 -0.9132935686930737651 0.36736086973439951997 0.48433235497945509307 -0.46643001535853778616 -0.84538611905732041762 0.56023584260266234836 0.41812400156811485585 1.4718909653511713653];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
