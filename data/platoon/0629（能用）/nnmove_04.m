function [Y,Xf,Af] = nnmove_04(X,~,~)
%NNMOVE_04 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:23.
% 
% [Y] = nnmove_04(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.2432837396787;-1.77671183213846;-0.522218457189092;-1.87191152625995];
x1_step1.gain = [2.00451934292179;0.784249478632966;2.12176577495543;0.53194555728415];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9121083362406645634;2.6645132837485618893;-2.2372574086423964168;2.0179690374898209271;-1.580726506005960319;1.498889567054433325;1.3457455516996548184;0.78378373668668910312;-0.55276539147138015196;0.027644597584552489666;-0.28876647296274576826;0.62453944945355888141;0.87786221687406851277;0.97289276101698729526;-2.0640123478737311125;-1.5769041004757391455;1.9075330685946219056;-2.4021383790099237743;-2.7015908217977280259;2.8298846611820169805];
IW1_1 = [-0.97229518524321567607 0.51779347765569083695 2.196950660955367951 1.7308045797276749855;-2.3739738705036277366 -0.93995895644416482817 0.22165000449715716035 -1.4140835085719070108;1.3620181598221479113 2.2431004110909933402 -1.233055319934221794 -0.99792725750293154174;-0.89675030781367104371 -2.1543345319189382003 -0.52677180681852198152 1.4428003073055095662;0.74507446963073586943 2.1508991766635490173 1.5188824517439554196 1.0392434316320078302;-1.9474559704433256346 -2.1040288368893769189 0.44236873775704865785 -0.039641610628113561898;-1.9088418422547821507 -0.1813746390673820208 0.67319907261176092916 2.1003327413106989141;-1.8102763315032879277 1.5685808424351985746 1.7968230441870547409 -0.061279649889138546048;1.5602501782154167831 -0.73823217775439853305 -0.59881976621377097647 2.1879737792220570469;-1.0378605233144462261 -2.5063503535476598927 1.2477619666197443671 0.10474850403406696375;-0.61259903678002447514 0.38553768275018374112 -2.7381904903392086936 -0.30078926682517737046;0.72862884747035072674 -1.1035849937128856535 -2.1751686247571542232 1.1786025545682889959;1.4513609479779572276 -2.0538172742960343342 -1.0042812965716216844 -0.85510578434714357154;1.7434555061831114031 1.2940270678523395631 2.0464591370512561497 0.053692144172709045657;-0.6959876777477438381 -0.35662844013475974991 -0.95853168984441805556 -2.3508423691731064054;-1.2485565903494781903 -1.2789434912615800233 2.0243343802879421034 1.2599555379796829602;0.92191976095961725157 -2.6969347413643269817 0.73827640059868737676 0.42924321287013444959;-2.3215375561828879292 -1.4999029246026769346 -0.75070596553259094641 0.62232653487992573016;-0.84684052409915167026 -1.4989353829731648649 1.9199989218699580196 1.3107916743516871971;0.87391936771795353245 -1.024345080358443516 2.1906597572911401528 -1.6496608859380814671];

% Layer 2
b2 = [-1.5662610869468038821;-1.1599184321397459918;0.9148254189926388058;-0.59027168167695653889;0.18823159557060770153;-0.11109202713894286707;-0.64055847631137174947;0.89053102363710134881;1.1906184491174349738;1.5963085984696752107];
LW2_1 = [0.51517202662398264845 -0.35069476452380754505 0.39752670885737484419 0.33671027394663460841 -0.21507724983487278014 0.53845429057115012927 0.23012882562725775482 0.30212473076845303144 -0.15982779751356449016 0.47266391790472750412 0.10336325543606128541 -0.0060954289821440969105 0.62163938339257784893 -0.55383544082763291883 0.78599127268341884012 -0.31757231301185578909 -0.25336783234317900027 0.16923064609698043603 -0.26325119581885858544 -0.31749795206959802174;0.52520904127062262301 -0.34416157421111137626 0.029754321550672025581 0.034001921536060644713 -0.25218751947399409286 -0.33126522072878783476 -0.21008342328561849244 0.32024444672208540741 0.14127883615838382481 -0.45988634194097111063 0.44850325330021262316 0.29475560260679112279 0.56285802076805047101 -0.37479854668023915298 0.51860869668341269545 -0.55190945183597506229 -0.20620243752596689735 -0.10551414742928225121 0.024550145330525935394 -0.47694038110354025628;-0.27214225733075519953 0.013061024090916032586 -0.11989715805817353911 -0.36968436601585519252 0.3358077781888215152 -0.37991404438476877869 0.61556217041565342019 0.15434238260924554309 0.076021077647903750885 -0.051935542491065599113 -0.41938754023413638006 0.64096834851579564951 0.43127892715361809683 -0.062475559292991686422 0.022296394543183009618 -0.358439096493638365 -0.21949492143626680996 0.38800770090472608276 0.0087886780034849062287 0.19882911019242266448;0.18971850110765312025 -0.068263117115869922924 0.53976615602093003243 -0.51591857250331329965 -0.50667487370652308787 -0.50707590450917949809 -0.63266598691381037423 -0.31245097678013217246 0.50057632217570746658 -0.31577289004176567477 0.32326659285840064761 0.59569148896295254225 0.04847830720873573529 -0.047303309717451877403 0.21161060948098989187 0.1606844486309937925 0.23311991206871596205 0.16743689126218969099 0.4303545409559123569 0.43502143822036842824;-0.18393300169077095307 0.32425629621108931211 0.37807587437934203622 -0.59803442411502727438 -0.30639859823257170612 0.2596457652736948174 0.60629746154729080576 -0.61411078335526603222 0.025286519356770557898 -0.54727559120642799151 0.29110927594438790189 -0.55222178593439585903 -0.067078790446765082511 -0.18879873976507666189 -0.055421584126224443523 0.3425501186745361637 0.061452429284413814803 0.15265820837610363792 0.42058645021479151849 0.083887734865179863775;-0.20892836042292992071 -0.36205870935411293976 -0.21135806675309803948 -0.32126673343851480658 0.43728205887353838177 0.5066597397735580488 0.20798200312800446676 -0.1585118045247591867 -0.23609847402915232206 0.22461140929516740239 0.2235610039818829442 0.029547616294113638463 -0.48367748437598873101 0.17688261576876929126 -0.41058093893587938039 0.4168131122403475608 -0.13917721491086462726 -0.34743339503346371 0.28262591227611866262 -0.52454997518878854201;-0.57941497450093815136 -0.61878798427763070933 -0.29895020454913168173 0.3834235385290037379 0.12508424988427155333 0.24456983969501894238 -0.22558365068257602015 -0.33348518134362115095 -0.10461656003836496132 -0.35873521822033904716 0.24539769831194840899 -0.33718650873295941128 0.040991103849189816644 0.086764162218924606451 -0.33695802158866411391 0.32304427506251037761 0.40960671643820761867 -0.57573606841676272516 0.61481590932046226161 -0.069572587606419961093;0.27310764458461711524 0.20823142400595565094 -0.61747161694914143304 -0.47471238261116655011 -0.32662164308781743705 0.44000318425898038432 0.086475015793357104532 0.72858143042986023286 0.41797251947944441541 -0.18618048739095832689 -0.39989127161564425039 -0.51918291593754839486 -0.38445808819542143242 -0.10598978286309419794 0.13203087587537779002 0.024936599978769735664 -0.49889701187234097857 0.28076586468182479495 -0.45051841544594350975 0.16083060725342826491;0.0082928722062380350738 -0.58525848601391872172 0.49877459529687467876 0.097432388298049482644 0.38839934802066106156 0.29049570436798682893 -0.32288275884137607186 0.38648089542560110088 0.25717336316636035809 -0.51251535714640727992 -0.057283878533890136842 -0.21108221717853881128 -0.22157632177645625315 0.54681341241733372183 -0.34681463575106979969 0.0083834813743583549983 -0.49889087745482751934 -0.35261539156492427427 0.57835608816314654224 -0.48921254405318664871;0.42948596607042754947 -0.43608749963889548162 0.63465347391596160787 0.3418640489690716322 -0.26902229578140041122 0.084402355623586347577 -0.20579914634630905312 -0.00458593453897343864 0.20618139725440459697 -0.33414215483598419532 0.35400932043909627556 0.40159801316426646522 0.057789990630682866457 0.35840179189597881626 0.16442102758487076031 0.70853765283030822886 0.043978385016541290953 -0.18353915640798981745 -0.40523560432252697661 -0.13445127318714999998];

% Layer 3
b3 = [-1.9302874341247431289;-1.6948269254794197103;1.4421244771947305807;1.3199075445182446575;1.1642655960131420567;-0.87677752470001757423;0.70471176139123137272;-0.47528903148741930007;-0.2089626828739664377;0.27215388573379106774;0.11249175351728414596;0.28480494087580954243;0.48255474647860252535;0.71648031488833385794;-0.8692392785530366206;-1.1688473631188744939;-1.320032632613529433;-1.4814180763070534663;-1.6815549528733775286;-1.9139824687120401414];
LW3_2 = [0.25729605660552695712 0.44982755350431219421 -0.8263936488628039756 -0.57307394856941373806 -0.81073327672617645501 -0.51871387379544930951 0.80157274758737961928 -0.17782593385130956998 -0.54373654907168456063 0.48086138864712485441;0.12303766790589643065 -0.0076894647661402797112 -0.64428860787732133986 0.32403102555663504392 -0.90033423119753552832 0.71172290897531875764 -0.12494229772416176605 0.88148362898950993749 -0.696720940770164332 -0.70243738870347849357;-0.82006203309814029723 0.756753759227001499 0.18036594168703840024 0.89465743331418756679 0.69371309786058898972 -0.013335825581054994854 -0.034248003062573251221 0.046435772425332394464 0.28936348050239085739 -1.0543280896344340292;-0.25589424645614328169 0.63727419913903249338 -0.55115545985800984408 -0.049513020253216723232 0.8561064143297254514 0.053007511923598801817 0.18462178808486592874 0.56882056770966527015 -0.9366353663765364379 -0.8182174668773687376;-0.16533197004868721569 -0.58610212320146781728 -0.42053964262675913588 -0.71648980525204175596 -0.39732880810877169164 -0.82791617266280592702 0.64975284975313241098 -0.72519963201547932297 -0.04926901448468890693 -0.69974814312354427503;0.15137201075035561226 -0.83724474779512259026 -0.14475582140600873338 0.39678360442015664367 0.96645415934605061192 0.52111507161694947676 -0.91006451156625389753 -0.078731174922631083635 0.28486108812290855674 -0.67628121347673242347;-0.80855304801380323276 -0.75798015296931564588 -0.212385538822529224 0.67588492208741401956 -0.27794022672219786951 -0.015610450609812264594 -0.54446696841392938637 -0.71201435100756005347 -0.62386024504749271191 0.73840392438390045626;0.1840569822889314977 0.32843327771412367255 -0.4330833381140333227 -0.68694311437871835579 -0.88882392329808157516 0.16627727484241028311 1.0541025695011443375 0.4003406668196584639 -0.62467375204309183445 -0.52785014283608333585;0.78694779737011888443 -0.36653228928734060688 -0.13729282185562524665 0.63405161948638977254 -0.053446508634586234465 -0.43352026572284318995 0.88672462480592184608 0.39925851376136684001 -0.48580619242743933173 1.0400433745502437599;-0.80733860419860170587 0.79718792234659341389 -0.35691555570188809865 -0.7196164915119113159 0.13974648195456676469 0.23959649150664552586 -0.29362200533781224188 1.1155556576913405742 -0.58067832607967451164 0.34437197355126031306;0.45740011022922366646 -0.17850090819214606275 -0.93026923227982216691 0.6638313034715348504 0.18280649541560439753 -0.85922641943445421386 0.61398070652494651789 0.33420716347360207577 -0.39220783367461603541 0.75793140912731360448;0.97547886637623348882 -0.62451364006489162861 0.65596640575490805514 0.80439736235997583158 0.13416764605755826523 0.066197738324002775023 0.80542837269945066758 0.47668281001254070306 0.84948560631877512161 -0.27382914196454993805;0.30450930113872098914 0.14729948444752635761 -0.84914986480794707457 0.081960719710242393998 -0.5593227665921333136 0.85678190058674219554 0.42460133371806252356 0.86505112808947381975 -0.52526074294475044724 -0.61297378936642188396;0.52681650334197371865 0.99138526302535601165 0.74536471503570556063 -0.11611261958041772802 -0.79212886049560138346 -0.12502612570713739215 -0.31743465773566198473 -0.1014311344935276693 0.5448973102830040327 -0.74841902576145802328;-0.59001915896115975091 0.44530252314060125851 -0.22446408032582571002 1.1676511802563851461 -1.106271663880049605 0.44328268966126288531 -0.31163939098390414095 0.11295399591860159905 0.21408588886471593971 0.1395035375137779754;-0.14709918865641075092 -0.28208134792577777006 -0.50357394463074334201 -1.1665341728711429159 -0.82653033338561976429 -0.3730938737701399166 -0.086077268690717814725 0.8213180215923838734 0.12424126543407477963 -0.67867048762302206732;-1.0914183285002871937 -0.50082120813571617823 0.61353734917144731043 0.10483213010266409504 0.1360028326129131826 0.17906079412182956956 0.3919287220823696738 0.78737181335456596365 0.39023448516235809125 -0.48960827441013271555;-0.27395604077109719787 0.83293152052806174179 0.5793164076094073911 0.29922589127316540081 -0.1000949461268004631 -0.50782860966503329259 -0.089788961009377166178 -0.73082831011247528785 0.64681097368019757621 -1.1010095842252021203;-0.24826569755336760914 0.75305586656594281081 -0.58904045800794424537 0.41513006490283133054 -0.69239233129842192582 0.50146922363363810593 0.7995087619601745077 -0.83102080417517198985 0.64771733039809054056 0.15698218083310283566;-0.37397749232459309709 -0.19687541084250190226 -0.71267477500665754597 -0.52481977367875276563 0.38338840331410306561 0.59365519885748474493 -0.26637748405910166571 -0.86146384265028275173 -0.71149267047341946402 0.86159738467039159726];

% Layer 4
b4 = -0.92658278433848362265;
LW4_3 = [0.53730481616999448136 -1.028752080789242962 0.33905228276575805069 -0.13490611624040094174 -0.59178384846216081083 0.034207045072440593614 -0.073467376036525089411 -0.15496901562605572278 0.72357054405230170069 -0.70445321929339888012 -0.062423635765879052772 -1.029144681080591317 -0.0056106523880857881587 -0.13590201272071056326 -0.66862556343528389835 0.36492848862721777303 -0.57017120867706239107 0.25611801239397657959 -0.74157468696163886257 -0.087872043557722295803];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000001;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
