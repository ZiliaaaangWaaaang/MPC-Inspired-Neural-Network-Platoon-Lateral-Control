function [Y,Xf,Af] = nnmove_16(X,~,~)
%NNMOVE_16 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:36.
% 
% [Y] = nnmove_16(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.581224840168548;-2.08798180279202;-0.533403245818273;-1.89546903030855];
x1_step1.gain = [1.49735732495204;0.473316379586819;1.97939958841911;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.8217279300237394501;-2.4107383538706668169;2.232005734791222995;-2.0741001159004537335;1.9812741065457031286;1.5158585629516925231;-1.117706079064179514;-0.88609927724081383182;-0.14944012410062496032;-0.41889866575410517058;-0.10526800088309218317;-0.7188952783008902836;0.82464680676639956491;-1.200937176554982555;1.3183519580365599122;1.7938387577054031308;-1.9872224962611766408;2.8382530581656126856;-2.7162833778104618077;3.0678939979597088517];
IW1_1 = [1.3194223658417367773 -0.040900452041241860957 1.3058470575889831178 2.3801924576448270088;2.0282605719543544964 2.1114223039689785644 -0.59209168742571005595 0.9987635323806045573;-1.5660961786232863169 -0.94772020733667017289 1.1151618952752260228 2.2941728782133128384;0.79746208489310654866 -1.0484780295196483024 -2.6540219967391434075 0.35424210916850790154;-0.61986201235712767854 2.3465328839557249019 1.0001391381775839307 0.91573354129037487503;-1.7034343705088825782 1.0386483520025970861 -0.98856991596098209296 1.4503456191614843007;1.2650716338398639849 1.8467244081637295139 -1.2159562929844207613 -1.1376515349403097943;0.7968057989165429067 -0.18516322088329406625 -1.9607450453338994834 -1.7383367860340668276;0.52893199481207420209 0.66923800058351479159 2.3355451334072294678 0.35748668948985096172;1.0972808168835188614 1.0447645758693289153 1.448435755522695656 -1.353370021447076299;-0.57119362291282826938 1.5128242826434179502 1.8427807201215187227 1.5490052740829083344;-0.9763995998390138098 -1.3580014923176704222 1.9534878274587919034 1.2645700448993213438;2.1045158543121149641 -1.0600105059880897684 0.82425055474892150453 -1.4532774019270839894;-2.3381539497987038345 -0.19498415599539470344 -1.6438557369615556247 -0.34830978601917900184;0.50706069984051527211 2.609599659214105305 0.28903613052921445226 -1.197008942907391793;2.5647123054467284575 0.75238306900649798425 -0.19929142721535555993 -1.1230557542151884398;-2.2565825160313064401 1.2323437033937154617 -0.31870266999191793067 1.29884923164241739;0.31813934067242083392 1.7372220758153986697 1.7603396020929249488 0.77185637312322030734;-0.474088215750666786 2.7263158145726515968 0.50908792626526266911 -0.74495528576619429728;2.2495975827228398281 -0.40105962380109644316 -1.7709509232278828339 0.44010092056441180164];

% Layer 2
b2 = [1.547434485215393174;1.1900869445684978398;0.88812309997014671215;0.58175564062009987865;-0.13359149004378628733;-0.22594753013127474861;-0.46440749195146058259;-0.79796735344954650149;-1.2675638953760874905;-1.5914699266739293915];
LW2_1 = [-0.41312225576592598308 0.51311472808258384859 -0.10476432862232194776 0.55072103511553538446 -0.29769865207054313494 -0.24701829179348405718 0.46441252837377083873 0.36062768692390961833 -0.54218966805297896805 0.053990598529187805443 0.10500705109902921941 -0.30807061389706674737 -0.33404315674702644845 -0.18559841268596483088 -0.15923840300372510415 0.51977666760251861611 -0.1916692684296994742 -0.39568572589819289709 -0.30801472410559554982 0.180375609853354546;-0.33844087171549358528 -0.41671670757504397642 -0.55962256126480647289 0.52537363340951814816 -0.34815431904242150063 -0.033860746725791354694 -0.4857681716575431019 0.36065339321402117845 -0.28425002566982343621 0.092436454703719334036 -0.3007816176131681285 0.57380314861187897701 0.17219388968784549165 0.52307712263100103467 -0.39981845009771238564 -0.11126689797927893921 -0.40348385153409815906 -0.13705610590843261831 0.24645019084794375641 -0.43441823950878316607;-0.59779268821032605086 0.50290443353781488778 0.015567307708326524884 0.40146721985861527626 0.17556058936053819952 -0.16477356958188382752 -0.18125588056417052396 -0.011238606360367553449 0.65739889009550334098 0.28244773894177743756 0.09439545623915795991 0.51274455526032114427 -0.031574034921909487073 0.080885294956019523904 0.18139709016221777782 -0.36621740978052408355 -0.10176866073343843189 -0.029500897929074842985 0.50973483334524039012 -0.2245569269329877049;-0.49957290696932027396 0.42993882959749507577 0.33731406530906715702 0.065232882961124186161 -0.28223290784387522478 0.18746732834185261818 0.67895552077597631779 -0.13938887631881846652 -0.36562113814520635913 0.42934065951737460098 0.44763459912355524351 0.091274822381106346381 -0.2153488224839771592 0.26181180559647854178 0.11409222062424601019 -0.23076909796265387964 -0.27288484507921623168 -0.24635556913641459831 -0.02852967586013371859 -0.39613652280023409213;0.27748548947526063824 -0.44494959080702778387 0.15497653782096987296 0.30807066266713356573 0.13206524847451592275 0.067659782908248256028 0.021111507799759766935 -0.080938755563089465062 -0.53865436462860083466 0.49333671913317539426 -0.31282668340212615998 -0.36865047014806884285 0.49355245334730057927 0.22074700833934551847 -0.53729424569281258872 -0.12898159359967226179 0.092021578336491341443 0.018110301362600132735 0.0059522550826255002376 0.57445131874492216806;-0.37265408696587176696 -0.61583255924053503794 -0.0068174478331677387105 -0.58595981756051340739 -0.15264683408160581446 0.33493821944879564878 -0.62078429646590727042 0.088978408855824420165 0.36272154894960761951 0.40231044575997831902 -0.092266366596045271131 -0.41606602582843388305 -0.4092201339583829145 -0.39812533518263215626 0.22377511401826960524 0.33460256324331666411 -0.40577194254160126041 0.072902007531091675419 0.16762055795738034503 -0.50026727953704253071;-0.52648954375357481794 -0.63993721358125921217 -0.29477925956176259659 0.10419442674285382677 0.20925853591805831933 0.31508419142724758411 0.48890934544555508801 0.17928733791131290509 -0.22171552049334661283 0.31919091422130124736 -0.4165858807317613377 0.23387021283869730004 -0.084555068761749216377 0.48271442058771757422 0.34423019259718501406 0.30502978501796673694 -0.14183196959043709029 0.0041181074715784925927 0.59209422447602744199 0.31429987801990599827;-0.15681211138773004654 0.58760267356772566405 0.23427010569196901613 0.42091320222832495634 -0.19228768643920007841 0.17708157512729322258 -0.30745795666531056112 -0.039933317881927249404 0.30929986970428624549 0.3030571333248842647 0.38680256679185909263 -0.4709993009741229586 0.33443587231961757755 0.49679008820435754945 0.12652046624271545694 -0.15973808075723402999 0.018313673868704381797 0.59982970017237657867 -0.21882770510326934876 -0.10372132589528335056;-0.35899043692721599452 0.042935973964591478413 -0.13885210944809375788 -0.3987225144353422901 0.26407039218580097284 0.16282192750562632377 0.74076991217128695943 -0.020073914121967982582 0.58977059156802291717 0.61982477021066351153 0.11455149303963388374 0.61925675910503574784 0.42915591146366272035 0.45630163665982192978 0.32379540982172738683 -0.18899603656606919766 -0.049186905422588932113 0.047200503479845813681 0.51834930063465534111 0.22419694572001200306;-0.37327466901631939367 -0.2648730581967532749 0.1883844801454584994 -0.37469267383353405121 0.23461251971592417265 0.043103983886865898656 -0.3648891152827330453 -0.15455876402078669307 -0.58516268584621833337 -0.19485338633006943354 -0.48788300698033948422 0.42348144074202104248 0.43274637768819523842 -0.075218159379224144856 0.3856118527611301916 -0.44851780196529777989 -0.43324614977803543869 0.18205878950838372266 -0.16287481102374343211 -0.14498794319862623459];

% Layer 3
b3 = [1.882938059486864546;1.6829229580074529515;1.5406891812206742198;1.4604267523136988949;-1.1047577330970548282;0.99177020338538046662;0.72363520943983694611;0.44618401048020567279;0.33404115165168596358;-0.084316569478173675201;0.15158375780514254938;-0.085240923668037371641;0.39601537429281791214;-0.68298339900011362236;-0.86328391752793764979;1.2031442338312090534;-1.3657573177660209396;1.7131093167352904327;1.8285495669833125021;-1.8578678353708426574];
LW3_2 = [-1.1008435606725035516 -0.43091374675170118769 0.50849167362795466563 -1.1208715092316250406 0.13558001436399594319 0.044514710572817750567 0.098744755759799560102 0.18607423450619595129 -0.44919182005959468196 0.047993814194766601378;-0.049302092507774050723 -0.70850826979056746868 0.30522587898261510642 0.918967787894731436 -0.4193275062611478976 -0.68638711054903112085 -0.069386210106501866601 0.40517326242368317812 -0.87851307168785142121 -0.71163421156888373442;-0.54342245193706251172 0.1226249188653677491 0.51544283710306548763 -0.56379530427267809944 -1.0865014189865684902 -0.091543160103853576937 0.13152063918501361028 0.43006233353299844202 -0.80331513170693147341 -0.24338891998775080694;-0.72693310082616080514 0.59451923346363833023 -0.5962263210097791255 0.014757497529023062832 0.55946267174997510452 0.44701399785878204174 -0.23053905105357458405 0.57688075447669928675 -0.5861459250573320956 -0.84751076480608578123;0.18228386676425023527 0.077538487795583130313 -0.33741131152760844847 -0.69611640696513843451 0.11303825156751248771 0.33381668672309061652 -0.6976748230978864207 -0.74287910885389174531 0.89837852933755069085 0.86151851499848686178;-0.27915365334910802186 1.0104496925846297994 0.76328933177320157366 -0.20724743278961202386 -0.14207838665071353956 0.3389081933422513071 0.91547651303309607318 -0.72903602101908993038 0.25509895519520775498 -0.0085250306577646321055;-0.8574525946607129967 0.53368159740672493907 -0.67485494917223443068 -0.39904788003265967422 0.67728891043670225169 0.89458941415530424113 -0.26662758959775118006 0.38683332718158869312 -0.33884187814717742215 -0.47715482623400123918;-1.0324216938051866688 -0.6575148002406824288 -0.67152387870800211989 0.32874435144639813089 -0.81542722868984640616 0.14651715346432941933 0.18018749750731458126 -0.31502282024142563843 0.78618562190994123462 -0.25306838292726241413;-0.32045385899254336115 0.14341619109170428148 0.44004100577752480739 -0.2285155715682655464 0.49738368308410851881 -1.0290086562940583548 0.028594329182972527681 0.3130687730573409322 -0.72444424743490765106 1.1951272549815374902;0.680237128981895256 0.66515648008032268734 0.35758385637512407618 0.27260936224058179844 0.039763824733213597173 -0.21801087356842024922 0.37665976632614478481 0.89155466188562915164 1.1174493037428629982 0.43949011353775513378;0.81976104387216974789 0.83440054698308152581 -0.44551693615733334308 0.86957047573456791589 -0.1655770942452018113 -0.022868555102107467059 0.26031443201582565861 -0.60934624210120136301 -0.48245754937334367485 0.69076949106878215989;-0.22649530482384636065 -0.044314975792747866856 0.14307548142526002599 0.95014578807974781061 0.45873892513608488519 -0.47594185150005191565 0.53496311855951939052 0.85801443141551247962 0.23337163442048997064 -0.95466054833423363846;0.39727877728448129924 0.68748519837407784383 -0.34039177241964513332 0.050780250185582992417 0.74741739762671244307 -0.42585753236756734852 0.49146842508975419062 0.89129805543410722812 0.74369948922960671389 -0.4174380222730494916;-0.31573571183243531735 0.28641867215115368595 0.12627653302701391524 0.23098384887889175654 0.85031525114729245018 0.13789609479983311324 -0.20014221412433425007 -0.10949157851449758949 -1.0606908346585548486 0.7297163469113606693;-0.54220284112834038481 -0.70577463786418692671 -0.27779929979335021839 -0.37538099945927716483 1.0325992161554067295 0.12580731620031371243 -0.64612525823930344604 -0.36519254334042050569 0.63090724618612503694 0.64343568509789184073;0.35313528523742232501 0.95900779799454571872 -0.16108736565037690136 -0.65299906182718148173 0.048085477851310461095 -0.22955891934611311056 -0.72483179188880098032 -0.61201931167788936605 0.98772410074259708868 -0.015740519594084449728;-0.26422388549376596423 -1.0905195770685527368 -0.084828852501972973332 -1.0422404035778527476 0.34713945286609032559 0.034224265372311164779 -0.27033676829106462192 0.75977872352877551254 0.34844873224847422444 0.3980987426442657573;0.83903550465810161629 -0.31924962994609140665 0.61966948295587498396 0.21834575166761019394 0.74784105872692274719 -0.6947524026214644266 0.76706188992328794285 0.50782176541105139567 -0.4320703702882249253 0.48389159852848029342;0.39245735005400372852 0.2839061937535760638 0.98172442827736394744 -0.11710862935669119622 -0.58630972146397086764 -0.32101282582377327346 0.91956851303535258602 0.35834375638736454261 0.41245597736222844309 -0.55987044982407019322;-0.22382435378480744492 -0.55335675165423181543 0.65085577508112824052 -0.85277103473874515949 0.31538449414002439619 0.0063927758878840751366 0.54924117707763542295 -0.52693871036618311621 0.79040856212340127041 -0.92636233438335080503];

% Layer 4
b4 = -0.74244993292085248449;
LW4_3 = [-0.6136237497418417508 -0.46420407759111975698 0.29661395766528403373 -0.26222091362906685408 -0.34213090397253465014 0.39522684806380081746 -0.08161362205729981445 0.13473764255653775113 -0.18204915060713838804 -0.15271715645975894593 0.057596153823824408624 0.47291767573311710438 -0.15360034806727307366 0.99572615425841692893 -0.13926013968168377 0.69719396462733718156 -0.04635382275429968113 0.69812852540667158507 -0.15247640039089077613 -0.31450563224330690959];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
