function [Y,Xf,Af] = nnmove_31(X,~,~)
%NNMOVE_31 neural network simulation function.
%
% Auto-generated by MATLAB, 29-Jun-2024 12:53:51.
% 
% [Y] = nnmove_31(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.644786415382709;-2.24855099234896;-0.581789816284725;-1.89546903030855];
x1_step1.gain = [1.42933908693485;0.45598879896227;1.88894161457496;0.499777584457468];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.9446565418980688023;3.0316715458802798722;2.4581294660136197017;1.7710052774893718652;-1.9329804587423828899;-1.1320964121749048648;-1.1933638414333771482;-1.5183252328310554713;0.57345840707477258036;-0.39467060251177765728;-0.31118775229496153933;0.26842828383374700563;0.82050876281912599186;-1.1838903892338485946;0.92235905441133692051;-1.7783115459214442478;1.2921071933100145568;2.6189485544844459675;-2.4402825635495490886;2.7204896007777299438];
IW1_1 = [-2.5296435326021655676 0.067725459065427706662 -1.2888648007921574834 -0.83197967716564724672;-2.5271049427502192408 -1.0613764919395327624 -0.67116819948389505601 0.42606865328851994956;-0.34605599015931015616 -2.3109088535474593407 -0.20169031791463221115 -1.6841758243584277199;-1.5310873300094660632 -3.1499923504622668879 -1.1771086437122633139 0.12906649006374773525;2.4318806578769520677 0.65544577966056327689 -0.82670459847722033153 0.12397663735372624338;0.65666744660812770285 2.0954935045129698956 -0.64594354962937405862 -1.6662503255362499655;0.36709180678391212238 -1.8357745857510849863 -1.6414681180446712983 -1.3543979294571173444;1.1902418547926545411 1.7974242436735070605 -0.4058806232881594922 -1.468349909212252502;-1.6003252649405370622 -2.0402514781140745903 0.84582967330277680773 1.3705980497351157865;1.6628348196221556243 -1.3298553799632812922 0.63229102368054579397 1.1934776456172031533;-0.05861560344355210006 -0.38550198191013557159 -0.25822499132577986236 2.7132448659974373051;0.21940934040999809929 1.8276099143503750089 -1.7509733755817666889 -0.86775314230017686068;1.7912037468313695143 0.66529305189139753551 -0.75941376796299508989 -1.947306466696860916;-0.70160567337985824121 1.6058003465410526367 0.05433583537843475475 1.9936631382021516856;2.2706168586882355953 -0.56025758032566108646 -1.0692539529032991652 -1.4293055860033490045;-1.9267904531227684206 1.8882049026156151328 -0.67234597992036515546 1.1010331279862184406;-0.072747037439216219457 -1.8309734813693696598 -2.2679203949639492599 -1.0291739421385901476;0.88670166466449706899 0.7448524907996142419 1.9630895243421662144 -1.9756543402008903687;-0.93903464052967300368 1.7842132601845108741 -1.4094457660864365689 -1.8600367087458089532;2.1363049160120395342 1.6047170983817908851 -1.6398131378039262351 -0.55946555646889284397];

% Layer 2
b2 = [1.6327624845974553214;1.0654932440974937968;-0.80724677170364944612;0.47052072037834408169;-0.2392035094635309167;0.11807510004112568847;-0.51327035355116357174;-1.0219633246588397668;-1.1016868885710069392;-1.665278041093210426];
LW2_1 = [-0.046952628896500051003 -0.28710558354331744413 -0.32480559859574797965 0.83222015015144268357 0.1355172786990014866 0.0702945982437573752 0.50768658107292230497 0.39177024991470976722 0.0040532047887527622443 -0.070961617985372718587 -0.36500267863976249005 0.061335613864243694604 -0.53785038976143850764 -0.41058864561248442637 -0.086608973788955184725 -0.22882520138509729324 -0.26891923768673764439 -0.64277054870229011208 -0.42450200782169694724 -0.32240642131571828344;-0.4714450322959771178 -0.19913695068487635709 0.053218850874054653144 -0.32876110798658142453 0.48091368571669484977 -0.28679155915693010925 0.09587350357973473125 0.28410148767366061318 -0.029142586516765423693 -0.72498641074779834881 -0.3876651305053833152 0.067185633538382583119 -0.63783381969535535294 0.45676525661128936084 -0.30244917555540118403 0.43865146952703343297 -0.27842087451755842542 0.63492928379689295149 0.69530889923320171597 -0.62225632875618064332;0.59841329673000853706 0.48690919225459228237 0.14299503642174588025 0.24516736593205584738 -0.41187305044028055256 0.40531969035792481115 0.65789494305157403264 -0.28973259332169476465 -0.24251373406320839154 -0.14180918282241294914 0.043420115307531745308 0.41003805780762114797 0.19837513952185220623 -0.21558898397818337944 -0.2662092907642273909 -0.40738760240531940449 0.070605926041585026498 0.2238610286256618731 0.35404881089718770459 0.10707200294356411518;-0.26602429327698484673 0.36555559241719065566 -0.23486858988664260917 -0.89058462789931658321 0.12910502253753913804 -0.26812476991627132161 -0.81111300943485153958 -0.54028960576392937032 -0.46016226805119553322 0.25991371793109674382 -0.15149849203626000738 -0.024087071816721650208 -0.10547902400954872748 -0.17883327573282309375 0.57798084438528674056 0.041475683411733563211 0.60812623623237449522 0.14161386980039636363 -0.33260580423521646232 -0.83079411035010686248;-0.074106975522740009543 -0.59530280242199484775 0.34438869372062552721 0.34437851120782758674 0.077008114690756024334 -0.42576821346267013091 1.0402614707793000903 0.10681798123744709605 -0.15616287958292537907 0.037390286237989241169 0.02054251836323983671 0.21397508800645848037 0.075415557159415280708 -0.56146797641468293438 0.60242711330654530322 0.11207016049010248837 0.62381076230145338091 0.23591191140432973827 0.11390440438528605382 0.025952792917663891625;0.14372381007781992457 0.5942951395657206648 -0.30935415449448877556 0.75027756929191080637 -0.37347300030939728499 -0.37464471844991115157 -0.81510075564411033078 0.62748311484141328087 0.2850146706406345154 0.20185211004231504162 0.53491692880125174536 0.18404946049590964474 0.72619943091941174806 -0.381016038993632844 -0.12522457343659415541 0.38668598554475341889 -0.080957021067666751213 0.20319448701233444599 -0.088399020314485377003 -0.62815926582519243659;-0.19200089795966268635 0.36453432447769645863 0.48822957794289373323 -0.36879518196632465887 0.25590274877453267344 0.35595418571556125542 0.027106061855017099527 0.16666381397796087294 -0.34899448118776593697 0.067963566390845997489 -0.43354983058110985183 -0.023033754200831906694 -0.15577794682827872386 0.086329287989144659621 -0.097864176935172644822 -0.054881782263390938015 -0.053669836288148392578 -0.30683463021915052815 -0.32912841682483651162 0.20368386740937993729;-0.40947132571628980235 -0.1282816449496397837 0.36910092706088504233 0.062995217101852823971 0.38137763587920986419 0.41808727359145592128 0.21716794738846345592 0.28806225668230500681 0.039961823336255648809 0.63839013767993157966 0.61029507558552875679 -0.62363959092127685402 -0.46937688560194884557 0.19202378855978835537 0.026528966063426990402 -0.25317046910640722546 -0.23450547185883785506 -0.010915786901619560501 0.28468671762430058925 -0.56293082411828765377;-0.20970788055302350128 0.015511225667737958689 0.24952185843816634958 0.0857905689960163087 -0.0018463448825275993737 -0.12303173764088851105 1.0595405518882716756 0.33842682219604958149 0.96482867647300962766 0.27714833372485281338 0.1073444513239343312 0.27008289231185983459 -0.041728005339716260635 -0.40463284026920448566 0.029020387164878952424 0.41134138780186335627 0.8572534927985901998 0.0072511189920367920964 0.022568656284594534878 -0.014991076901795130638;-0.59767936351058026379 0.42623628497436905072 0.11097420376072533732 0.57796705165111750269 0.20254308854658698014 0.34462220447037400506 -1.0659325943447348628 0.079389357509347099895 0.30199855083185017657 0.010171260476501606945 -0.30704858864856549028 0.10975854533540337077 -0.20587348377322375881 0.39785803025259880439 0.18643471995923174833 0.44995917384114197946 -0.59192792839310448549 0.79000895946121818536 0.0087095850366214512539 -0.039557335580816324616];

% Layer 3
b3 = [1.9189279090471862421;-1.6787840642388471846;-1.7533747323893154046;-1.5328833003714097405;1.2810491558737779894;-0.752929925001100675;-0.67407624506331220715;-0.72268008235540992512;0.40942190847328807646;0.053278185759338181349;-0.166711551046906159;0.46823779784986818697;0.44348116049974684039;0.65284024029840426184;-0.96970456190905796046;-1.1242198498666176043;1.1613046018157504591;1.46261596468622046;1.6721416708995342493;1.8426703497609235871];
LW3_2 = [-0.52038603256312387924 -0.17069619971243535361 0.06963440557345693116 -0.63563663146228654988 0.2562605995424452332 -0.28264436199175485553 0.73186755985580576045 -1.0118602290999709759 -0.66101082696809321249 -0.81377125148072848582;0.6871187389026263137 0.64684588921768448877 -0.01887259477355666612 0.94950298018944478962 -0.79429210868554323 -0.23493046808039577678 0.30961424214736998906 0.59324139679860143914 0.81551732831091383602 -0.0052796293326532583307;0.41752887933661497755 -0.040114033834751858243 0.37221455622833343746 -0.59231966279443337697 -0.94623015319886627505 -0.9364756245796835854 -0.026799678672784502109 0.52912249390345600375 -0.6556403325127889703 -0.34780799152858804524;0.25455565198798024706 -0.51665323521931871831 -0.51527674114517707515 0.75430809116084873711 -0.37736973845370763714 -0.96362874089374450648 0.00048926701355097744137 1.0155542161836421666 -0.2257866832642206889 -0.33893677403503713608;-0.24301761864968915439 -0.20138404541434659634 0.81895216446922403097 -0.52379818825797197501 0.098015688371875728246 0.13023563565968271361 -0.4190455099511907755 0.5996331512213700643 0.86018574025120808635 -1.0399485603073108653;0.76492145145959167252 0.42316796388373273397 0.41597592831943541736 -0.11572102257052274688 -0.25621149384394081849 1.0351351778549424676 0.33336582830669869715 0.27747536250987564488 0.55562333329886515187 -1.2141963815426692896;0.19544033593104884194 -0.95850646120992877286 -0.68512413009096762018 0.58757132724807747959 -0.64452411231550377213 -0.25191600080024234565 -0.65595979167827067613 0.55570380444664035924 -0.59513679468965541286 -0.3444224473272549103;0.59020686053281434802 0.69091012889958647314 0.45001461205272580424 -0.70071306106148489867 -0.55059008967416156466 0.77366527282493335882 0.96182125305264531967 0.17034073584494124898 0.46166540076164008788 0.32659489037866368255;-0.57983283970337040625 -0.74431797782596209601 0.49820879290807795758 -0.19788564360715032997 -0.6538636158773809548 0.94314085293750948846 0.064795915848686935767 0.63785486586418294053 0.69539889179017722043 0.34502539696942557956;-0.98751846349721894569 -0.010293914401639563116 0.036864962573315541994 0.4369890749783247319 -0.2666814675101186749 1.1100807550415192626 0.37913500259706289786 0.50173181203600658584 -0.99944643648343656217 -0.35094186601256127656;-0.22349022536911239412 -0.20933579700285182001 0.17542518705465626194 0.95276823535461119263 -0.3102646364672270729 -0.063159421883390381991 0.36572562872680280943 0.65931042891979119158 -0.80710537168268148278 0.65285884481360945131;0.61458067721275000395 0.95752758904338108881 -0.85027344081881195414 -0.11767225631578998035 -0.19981253668544629587 -1.1414067603333284406 0.032203167113543776368 -0.69769878826924325299 0.0015481782279925804247 0.31558275376978683902;0.20588012766514990348 0.28772860185092752339 0.83692195920906486961 -0.31054532021577263556 1.0896991603691199568 0.79166033491899101548 0.18561365621788133984 0.00023994298670491215342 0.86538020566683093726 -0.57931088537527064553;0.5526074728185419449 -0.19521355376135915427 0.53499304841272332656 0.13244384932374259067 -0.38981682644395193593 -1.1407608353465081841 -0.18136739139190197201 1.1552468471041716924 -0.062977282119669630855 0.46870332348528437327;-0.73520180929763512268 -0.59037367494627712716 -0.026860462741793059149 -1.0907504990629268704 -0.65806499768905346581 0.20587073908419106782 -0.80764455373575960717 -0.10457736813719903379 -0.50579096854803673455 0.94465997831196457657;-0.69351485818598812561 0.10100984162906215258 -0.59614503716254874099 0.4287509712453528854 0.29573669207341807263 -0.46388670439436330284 -0.5657617606508940078 -0.36564886746703828546 0.95652029581506670119 0.81061640090568387595;0.86344532930003903282 -0.15965341014464709546 0.10778853400604078427 0.17641630561358884188 0.92388250570419805374 0.70921653559062192151 0.99429937437741378048 0.95618026529020649917 -0.53365763352784467699 0.065466711276908007289;-0.031692549438688245866 0.65939311695527236257 0.70930063924182173984 0.65810927855123846353 0.31052969170610955629 -0.23066559227176500202 0.33911629682211430481 0.84199403842910047757 -0.49697031999615942643 -0.97741093619928010039;1.0094591284040812518 -0.37334081985771677692 -0.66864795121650189014 0.22137129968931307245 -0.93147394055299781446 -0.40782404377866510181 -0.048681233165697918031 0.29092813871479988874 -0.42227278059381534447 -0.77002404001125945854;0.051918078244867743587 1.0564180687222173294 -0.8652985771803699544 0.020837522773446099517 0.67621591637085365356 0.41889055425404847499 0.32871123303841492946 -0.066012252349279626484 -0.9566180361187502923 -0.30422561626107363919];

% Layer 4
b4 = 0.036392815413362908372;
LW4_3 = [-1.0020706302214354988 0.18306887681394912182 -0.53790135257574622774 0.441480850211550091 0.32672151073947863775 0.34881329872016969551 0.02636812977731091065 0.32509791974335933151 -0.3062754387827261171 0.24905423726542993967 -1.3257966777913274825 -0.31438157013934547868 -0.38484542953384803798 -0.038569759412193788117 -0.78786826991489045113 -0.41944198506373348012 -0.78874143132827334579 0.29954304358705069466 0.34640186136499789837 -0.29113887701386209628];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 1.25;
y1_step1.xoffset = -0.800000000000002;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
